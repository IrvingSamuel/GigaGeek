import.meta;var Dn=Object.defineProperty,Rn=Object.defineProperties,xn=Object.getOwnPropertyDescriptors,Pe=Object.getOwnPropertySymbols,Ln=Object.prototype.hasOwnProperty,On=Object.prototype.propertyIsEnumerable,Lt=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),Ot=(e,t,n)=>t in e?Dn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y=(e,t)=>{for(var n in t||(t={}))Ln.call(t,n)&&Ot(e,n,t[n]);if(Pe)for(var n of Pe(t))On.call(t,n)&&Ot(e,n,t[n]);return e},A=(e,t)=>Rn(e,xn(t)),c=(e,t,n)=>(Ot(e,typeof t!="symbol"?t+"":t,n),n),$t=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},F=(e,t,n)=>($t(e,t,"read from private field"),n?n.call(e):t.get(e)),j=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},_e=(e,t,n,r)=>($t(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),yt=(e,t,n)=>($t(e,t,"access private method"),n),N=function(e,t){this[0]=e,this[1]=t},H=(e,t,n)=>{var r=(i,s,u,d)=>{try{var l=n[i](s),h=(s=l.value)instanceof N,b=l.done;Promise.resolve(h?s[0]:s).then(p=>h?r(i==="return"?i:"next",s[1]?{done:p.done,value:p.value}:p,u,d):u({value:p,done:b})).catch(p=>r("throw",p,u,d))}catch(p){d(p)}},a=i=>o[i]=s=>new Promise((u,d)=>r(i,s,u,d)),o={};return n=n.apply(e,t),o[Lt("asyncIterator")]=()=>o,a("next"),a("throw"),a("return"),o},x=(e,t,n)=>(t=e[Lt("asyncIterator")])?t.call(e):(e=e[Lt("iterator")](),t={},n=(r,a)=>(a=e[r])&&(t[r]=o=>new Promise((i,s,u)=>(o=a.call(e,o),u=o.done,Promise.resolve(o.value).then(d=>i({value:d,done:u}),s)))),n("next"),n("return"),t);const $n=":host{display:flex;align-items:center;justify-content:center}";class Mn extends HTMLElement{constructor(){var t,n;super(),c(this,"size"),c(this,"color"),this.size=(t=this.getAttribute("size"))!=null?t:"1.5rem",this.color=(n=this.getAttribute("color"))!=null?n:"gray",this.attachShadow({mode:"open"})}connectedCallback(){this.render();const t=document.createElement("style");t.textContent=$n,this.shadowRoot.appendChild(t)}render(){const t=this.shadowRoot,n='\n      width="'.concat(this.size,'"\n      height="').concat(this.size,'"\n      xmlns="http://www.w3.org/2000/svg"\n      aria-hidden="true"\n    ');switch(this.getAttribute("name")){case"warning":t.innerHTML="\n          <svg ".concat(n,' viewBox="0 0 16 14" fill="').concat(this.color,'">\n            <path d="M5.925 2.344c1.146-1.889 3.002-1.893 4.149 0l4.994 8.235c1.146 1.889.288 3.421-1.916 3.421h-10.305c-2.204 0-3.063-1.529-1.916-3.421l4.994-8.235zm1.075 1.656v5h2v-5h-2zm0 6v2h2v-2h-2z"/>\n          </svg>\n        ');break;case"close":t.innerHTML="\n          <svg ".concat(n,' viewBox="0 0 20 20" fill="').concat(this.color,'">\n            <path d="M17.1 4.3l-1.4-1.4-5.7 5.7-5.7-5.7-1.4 1.4 5.7 5.7-5.7 5.7 1.4 1.4 5.7-5.7 5.7 5.7 1.4-1.4-5.7-5.7z"/>\n          </svg>\n        ');break;default:t.innerHTML="";break}}}const Un="#overlay{position:fixed;width:100%;height:100%;background:#0006;top:0;left:0;z-index:2147483647;animation:modalPop .3s ease-out}#modal{position:fixed;top:1em;left:50%;width:100%;max-width:460px;transform:translate(-50%,-100%);background:#fff;color:#000;border:1px solid #d0d0d0;border-radius:4px;animation:modalSlideInFromTop .3s forwards}@keyframes modalPop{0%{opacity:0}to{opacity:1}}@keyframes modalSlideInFromTop{0%{transform:translate(-50%,-100%)}to{transform:translate(-50%)}}@keyframes modalSlideInFromBottom{0%{transform:translate(-50%,100%)}to{transform:translate(-50%)}}@media only screen and (max-width: 640px){#modal{top:auto;bottom:0;animation:modalSlideInFromBottom .3s forwards}}#modal header,#modal footer{padding:1em}#modal header{display:flex;margin-bottom:2em;text-align:center;border-bottom:1px solid #d0d0d0}#title{flex-grow:2;display:flex;justify-content:center;font-size:1.6rem;margin:0}#title svg-icon{margin-right:.25em}#content{text-align:left;padding:0 1em 1em;overflow:auto;max-height:84vh}#modal #content p{margin:0}#close-icon,#close-button{cursor:pointer}#close-icon{min-width:24px;background:transparent;padding:0;border:none}#close-button{width:100%;padding:1em;color:#fff;background-color:#1773b0;border:none;border-radius:4px}#close-button:hover,#close-button:active{background:#136f99}#close-button:active,#close-button:focus{box-shadow:0 0 0 4px #1990c640}";var Ve=/^\s*at .*(\S+:\d+|\(native\))/m,Fn=/^(eval@)?(\[native code])?$/;function Bn(e){return e.stack?e.stack.match(Ve)?qn(e):Wn(e):[]}function ze(e){if(e.indexOf(":")===-1)return[e];let t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]?Number(t[2]):void 0,t[3]?Number(t[3]):void 0]}function qn(e){return e.stack.split("\n").filter(t=>!!t.match(Ve)).map(t=>{let n=t.replace(/^\s+/,"").replace(/^.*?\s+/,""),r=n.match(/ (\(.+\)$)/);n=r?n.replace(r[0],""):n;let a=ze(r?r[1]:n),o=r&&n||void 0,i=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return{method:o,file:i,lineNumber:a[1],columnNumber:a[2]}})}function Wn(e){return e.stack.split("\n").filter(t=>!t.match(Fn)).map(t=>{if(t.indexOf("@")===-1&&t.indexOf(":")===-1)return{method:t};let n=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=t.match(n),a=r&&r[1]?r[1]:void 0,o=ze(t.replace(n,""));return{method:a,file:o[0],lineNumber:o[1],columnNumber:o[2]}})}var Ie="5",Vn=class{constructor(e){c(this,"breadcrumbs",[]),c(this,"apiKey"),c(this,"plugins"),c(this,"appId"),c(this,"appType"),c(this,"appVersion"),c(this,"releaseStage"),c(this,"locale"),c(this,"userAgent"),c(this,"metadata"),c(this,"onError"),c(this,"onPostErrorListeners",[]);var t;this.apiKey=e.apiKey,this.appType=e.appType,this.appId=e.appId,this.appVersion=e.appVersion,this.releaseStage=e.releaseStage,this.locale=e.locale,this.userAgent=e.userAgent,this.metadata=e.metadata,this.onError=e.onError,this.plugins=(t=e.plugins)!=null?t:[],this.plugins.forEach(n=>n.load(this)),this.leaveBreadcrumb("Bugsnag started",void 0,"state")}leaveBreadcrumb(e,t,n="manual"){this.breadcrumbs.push({name:e,metaData:t,type:n,timestamp:new Date().toISOString()})}notify(e,{errorClass:t,severity:n,severityType:r,handled:a=!0,metadata:o,context:i}={}){var s,u;let d=y(y({},this.metadata),o),l=this.buildBugsnagEvent({error:e,errorClass:t,severityType:r,handled:a,severity:n,metadata:d,context:i});if(((u=(s=this.onError)==null?void 0:s.call(this,l))==null||u)&&this.releaseStage!=="development"){let h=this.sendToBugsnag(l);return this.onPostErrorListeners.forEach(b=>b(l)),h}return Promise.resolve()}addOnPostError(e){this.onPostErrorListeners.push(e)}buildBugsnagEvent({error:e,errorClass:t,severity:n="error",severityType:r="handledException",handled:a,metadata:o={},context:i}){let s=new Date().toISOString(),{breadcrumbs:u,appId:d,appType:l,appVersion:h,releaseStage:b,locale:p,userAgent:C}=this;return{payloadVersion:Ie,exceptions:[{errorClass:t!=null?t:e.name,stacktrace:zn(d,e),message:e.message}],severity:n,severityReason:{type:r},unhandled:!a,app:{id:d,type:l,version:h,releaseStage:b},device:{time:s,locale:p,userAgent:C},breadcrumbs:u,context:i,metaData:o}}async sendToBugsnag(e){let{apiKey:t}=this,n={apiKey:t,notifier:{name:"Bugsnag JavaScript",version:"7.22.2",url:"https://github.com/bugsnag/bugsnag-js"},events:[e]};try{await fetch("https://notify.bugsnag.com/",{method:"POST",headers:{"Content-Type":"application/json","Bugsnag-Api-Key":t,"Bugsnag-Payload-Version":Ie,"Bugsnag-Sent-At":e.device.time},body:JSON.stringify(n)})}catch(r){console.warn("[bugsnag-light] failed to send an event"),console.warn(r)}}};function zn(e,t){return Bn(t).map(n=>{var r,a,o,i;let s=(r=n.file)==null?void 0:r.includes(e);return{method:(a=n.method)!=null?a:"",file:(o=n.file)!=null?o:"",lineNumber:(i=n.lineNumber)!=null?i:0,columnNumber:n.columnNumber,inProject:s}})}function jn(e){let t=window.onerror;window.onerror=(n,r,a,o,i)=>{i&&e.notify(i,{severityType:"unhandledException",handled:!1}),typeof t=="function"&&t.apply(window.onerror,[n,r,a,o,i])}}function Hn(e){window.addEventListener("unhandledrejection",({reason:t})=>{t&&e.notify(t,{severityType:"unhandledPromiseRejection",handled:!1})})}function Ct(e){try{const t=new RegExp("(^| )".concat(e,"=([^;]+)")).exec(document.cookie);return t?t[2]:null}catch(t){return null}}const Bt={BRANDED_BUTTON:"shopify-payment-button__button shopify-payment-button__button--branded",UNBRANDED_BUTTON:"shopify-payment-button__button shopify-payment-button__button--unbranded",MORE_PAYMENT_OPTION_BUTTON:"shopify-payment-button__more-options",HIDDEN:"shopify-payment-button__button--hidden"},Kn="wallet-cart-button",Gn={DARK:"apple-pay--dark",LIGHT:"apple-pay--light"},Yn="_shopify_y",je=6,Qn="discount_code",Xt="https://static-na.payments-amazon.com/checkout.js",Jn={CURRENCY_CHANGE:"wallet_currency_change"},Xn=["Load failed","Failed to fetch","when attempting to fetch resource"],Zn=["Chrome-Lighthouse"],qt={};function tr(e){return!e.exceptions[0]||(nr(e),er())?!1:rr(e)}function er(){const e=navigator.userAgent;return Zn.some(t=>e.includes(t))}function nr(e){var t,n;e.context=window.location.pathname,e.request||(e.request={}),e.request.url=window.location.href,e.device.orientation=(n=(t=window.screen)==null?void 0:t.orientation)==null?void 0:n.type,e.metaData=y(y({},qt),e.metaData)}function rr(e){var t,n,r;const a=e.exceptions[0];return Xn.some(o=>{var i,s;return(s=(i=a.message)==null?void 0:i.includes(o))!=null?s:!1})||a.errorClass==="SilencedError"||a.stacktrace.some(o=>{var i;return(i=o.file)==null?void 0:i.includes("spin.dev")})||a.errorClass==="OpenTelemetryClientError"&&((t=a.message)!=null&&t.match(/Server responded with ([45]\d\d|undefined)/)||(n=a.message)!=null&&n.includes("error found in #10 byte"))||(r=a.message)!=null&&r.includes("GraphQL mutation failed with status 404")?!1:a.stacktrace.some(o=>!!(o!=null&&o.inProject))}var We;const or={apiKey:"cb577dc231be1c7494db8a63441ef66b",appId:"portable-wallets",appVersion:"0.0.0-7c48c8948baeb5e176c0f672a32f5bde22774e01",releaseStage:"canary",locale:"en",userAgent:navigator.userAgent,metadata:{user:{id:(We=Ct(Yn))!=null?We:"unknown"}},onError:tr},f=new Vn(or);function Zt(e){for(const[t,n]of Object.entries(e))qt[t]=y(y({},qt[t]),n)}var He={en:{instruments_copy:{checkout:{buy_now:"Buy it now"}},error_dialogs:{checkout:{title:"Checkout unavailable",generic_error:"Checkout is currently unavailable due to technical problems. Please try again in a few minutes.",button_text:"Close"},wallet:{title:"%{wallet} unavailable",generic_error:"There was an issue with %{wallet}. Try again or use a different payment method.",buy_with_prime:{empty_line_items:{title:"Buy with Prime no longer available",content:"Items that were eligible for Buy with Prime are no longer in your cart."}}}},more_payment_options:"More payment options",subscriptions:{buyer_consent:"One or more of the items in your cart is a recurring or deferred purchase. By continuing, I agree to the %{subscriptionPolicyLink} and authorize you to charge my payment method at the prices, frequency and dates listed on this page until my order is fulfilled or I cancel, if permitted.",cancellation_policy:"cancellation policy",subscription_policy:"Subscription policy",policy_not_found:"The subscription policy could not be found. Refresh the page or contact us for more information."},shipping_methods:{connect_shipping_methods:"%{methodOne} and %{methodTwo}"},order_summary:{total:"Total",subtotal:"Subtotal",duties:"Duties",taxes:"Taxes",shipping:"Shipping",shipping_one_time_purchase:"Shipping (One-time purchase)",shipping_subscription:"Shipping (Subscription)",discount:"Discount",subscriptions:{recurring_total_tooltip_line:"Does not include shipping, tax, duties, or any applicable discounts",recurring_totals:"%{fixedPrice} every %{interval}",recurring_totals_with_policies:{one:"First payment %{fixedPrice}, then %{recurringPrice} every %{interval}",other:"First %{count} payments %{fixedPrice} each, then %{recurringPrice} every %{interval}"},recurring_total_intervals:{day:{one:"day",other:"%{count} days"},month:{one:"month",other:"%{count} months"},week:{one:"week",other:"%{count} weeks"},year:{one:"year",other:"%{count} years"}}}},brand:{apple_pay:"Apple Pay"},buy_with_button_content:"Buy with {{ICON}}",errors:{missing:{email:"Enter an email address",first_name:"Enter a first name",last_name:"Enter a last name",address1:"Enter an address",address2:"Enter an apartment, suite, etc.",city:"Enter a city",zone:"Select a state / province",phone:"Enter a phone number",postal_code:"Enter a ZIP / postal code"},invalid:{email:"Enter a valid email",first_name:"Enter a valid first name",last_name:"Enter a valid last name",address1:"Enter a valid address",address2:"Enter a valid apartment, suite, etc.",city:"Enter a valid city",zone:"Select a valid state / province",country:"Select a country / region",phone:"Enter a valid phone number",postal_code:"Enter a valid zip / postal code"}}}};He.en;function kt(){return new Wt(He)}class Te extends Error{constructor(t,n){const r="i18n: Missing or invalid translation '".concat(t,"' in '").concat(n,"'");super(r)}}class ar extends Error{constructor(t,n,r){const a="i18n: Missing translation template key '".concat(t,"' for '").concat(n,"' in '").concat(r,"'");super(a)}}class ir extends Error{constructor(t,n,r){const a="i18n: Invalid pluralization for '".concat(t,"':'").concat(n,"' in '").concat(r,"'");super(a)}}var ht,M,Et,Ke,At,Ge,Pt,Ye;const ce=class Nn{constructor(t){j(this,Et),j(this,At),j(this,Pt),j(this,ht,void 0),j(this,M,Nn.getDefaultLanguage()),_e(this,ht,t)}static getDefaultLanguage(){return"en"}get locale(){return F(this,M)}translate(t,n={}){var r;const a=t.split(".");let o=F(this,ht)[F(this,M)];try{for(const i of a)switch(typeof o){case"object":o=o[i];break;case"string":case"undefined":throw new Te(t,F(this,M))}if(yt(this,Et,Ke).call(this,o,n)){if(typeof o=="string")throw new ir(t,o,F(this,M));o=o[yt(this,At,Ge).call(this,o,n.count)]}if(typeof o!="string")throw new Te(t,F(this,M));return yt(this,Pt,Ye).call(this,o,n)}catch(i){return f.notify(i),(r=n.defaultValue)!=null?r:t}}};ht=new WeakMap,M=new WeakMap,Et=new WeakSet,Ke=function(e,t){return typeof e!="string"&&t.count!=="undefined"},At=new WeakSet,Ge=function(e,t){let n=t===1?"one":"other";return t===0&&typeof e!="string"&&e.zero!=="undefined"&&(n="zero"),n},Pt=new WeakSet,Ye=function(e,t={}){const n=e.match(/%\{.+?\}/g);return n?n.reduce((r,a)=>{const o=a.replace(/%\{(.*)\}/,"$1");return t[o]?r.replace(a,t[o]):(f.notify(new ar(o,e,F(this,M))),r)},e):e};let Wt=ce;var _=(e=>(e.CartPage="cart_page",e.CartAjax="cart_ajax",e.ProductPage="product",e.Unknown="unknown",e))(_||{}),lt=(e=>(e.CartChange="/cart/change",e.CartUpdate="/cart/update",e.CartAdd="/cart/add",e.CartClear="/cart/clear",e))(lt||{}),ut=(e=>(e.OneTimePurchase="ONE_TIME_PURCHASE",e.Subscription="SUBSCRIPTION",e))(ut||{});const ct=[];function R(e,t,n){if(window.customElements==null)return;const r=t;window.customElements.get(e)||(window.customElements.define(e,r),n!=null&&n.isChildCustomElement&&ct.push(e))}function sr(){var e,t;const n=new URLSearchParams(window.location.search);return((t=(e=n.get("shopify-debug"))!=null?e:n.get("shopifydebug"))!=null?t:"")!==""}function lr(){return new URLSearchParams(window.location.search).get("show")||null}function cr(){var e;const t=(e=window.Shopify)==null?void 0:e.CartType;let n=_.ProductPage;return window.Shopify?t===_.CartAjax?n=_.CartAjax:t===_.CartPage&&(n=_.CartPage):n=_.Unknown,n}function Vt(e){return Number(e).toFixed(2)}function te(e){if(!(!e||!e.id||!e.id.includes("gid://shopify/Cart/")))return e.id.replace("gid://shopify/Cart/","")}class ur extends HTMLElement{constructor(){super(),c(this,"overflow"),c(this,"formerFocus"),this.attachShadow({mode:"open"}),this.overflow="",this.formerFocus=document.activeElement}connectedCallback(){const t=kt();this.render(t);const n=this.shadowRoot,r=n.getElementById("modal");n.querySelectorAll("button").forEach(i=>i.addEventListener("click",this.closeModal.bind(this)));const a=n.getElementById("overlay");a==null||a.addEventListener("click",i=>this.handleOutsideClick(i,r)),document.addEventListener("keydown",this.handleEscapeKey.bind(this));const o=document.createElement("style");o.textContent=Un,n.appendChild(o),this.overflow=document.body.style.overflow,document.body.style.overflow="hidden",this.trapFocus(r,n),R("svg-icon",Mn)}trapFocus(t,n){if(!t)return;const r=t.querySelectorAll("a[href], button"),a=Array.from(r),o=a[0],i=a[a.length-1];t.addEventListener("keydown",s=>{s.key==="Tab"&&!s.shiftKey&&n.activeElement===i&&(s.preventDefault(),o.focus()),s.key==="Tab"&&s.shiftKey&&n.activeElement===o&&(s.preventDefault(),i.focus())}),o.focus()}handleOutsideClick(t,n){n&&(n.contains(t.target)||this.closeModal())}handleEscapeKey(t){t.key==="Escape"&&this.closeModal()}closeModal(){var t;document.body.style.overflow=this.overflow,this.remove(),this.formerFocus&&"focus"in(this==null?void 0:this.formerFocus)&&typeof this.formerFocus.focus=="function"&&((t=this.formerFocus)==null||t.focus())}render(t){const n=this.getAttribute("title"),r=this.getAttribute("has-close-button"),a=t.translate("error_dialogs.checkout.button_text"),o='\n      <footer>\n        <button type="button" id="close-button" tabindex="0">'.concat(a,"</button>\n      </footer>\n    ");this.shadowRoot.innerHTML='\n      <div id="overlay">\n        <div id="modal" role="dialog" aria-modal="true" aria-labelledby="title">\n          <header>\n            <h2 id="title">\n              '.concat(n,'\n            </h2>\n            <button type="button" id="close-icon" aria-label=').concat(a,' tabindex="0">\n              <svg-icon name="close" color="gray"></svg-icon>\n            </button>\n          </header>\n          <div id="content">\n            <p><slot></slot></p>\n          </div>\n          ').concat(r?o:"","\n        </div>\n      </div>\n    ")}}function Qe(e){e.setAttribute("tabindex","0")}function Nt(e="button"){const t=document.createElement("button");return Qe(t),t.type=e,e!=="submit"&&(t.role="button"),t}function dr(){const e=document.createElement("a");return Qe(e),e}function ee(e,t){for(const[n,r]of Object.entries(t))e.setAttribute(n,r)}function Mt(e,t){for(const[n,r]of Object.entries(t))e.style.setProperty(n,r)}function pt(e,t){const n=document.createElement("top-level-modal");n.textContent=t,ee(n,{"data-testid":"top-level-modal","has-close-button":"true",title:'<svg-icon name="warning" color="red"></svg-icon> '.concat(e)}),document.body.appendChild(n)}function hr(e,t){const n=document.createElement("top-level-modal");n.innerHTML=t,ee(n,{"data-testid":"top-level-modal",title:e}),document.body.appendChild(n)}R("top-level-modal",ur);class Je extends HTMLElement{get buyerCountry(){return this.getAttribute("buyer-country")}get buyerCurrency(){const t=this.getAttribute("buyer-currency");if(t==null)throw new Error("WalletElement buyer-currency is null");return t}get accessToken(){return this.getAttribute("access-token")}get disabled(){const t=this.getAttribute("disabled");return t==="true"||t===""}set disabled(t){t?this.setAttribute("disabled","true"):this.removeAttribute("disabled")}get hasSellingPlan(){const t=this.getAttribute("has-selling-plan");return t==="true"||t===""}set hasSellingPlan(t){t?this.setAttribute("has-selling-plan",""):this.removeAttribute("has-selling-plan")}}const pr=70;class Q{constructor(t,n,r,a){c(this,"red"),c(this,"green"),c(this,"blue"),c(this,"opacity"),this.red=t||0,this.green=n||0,this.blue=r||0,this.opacity=typeof a>"u"?1:a}getLuminance(){const t=this.red&255,n=this.green&255,r=this.blue&255;return t*.2126+n*.7152+r*.0722}isDark(){return this.opacity===0?!1:this.getLuminance()/this.opacity<pr}blendWith(t,n){this.opacity=1-(1-t.opacity)*(1-n.opacity),this.red=this.blend(t.red,n.red,t,n),this.green=this.blend(t.green,n.green,t,n),this.blue=this.blend(t.blue,n.blue,t,n)}blend(t,n,r,a){return Math.round(t*r.opacity/this.opacity+n*a.opacity*(1-r.opacity)/this.opacity)}}function mr(e){const t=[...e];let n=new Q(0,0,0,0),r=new Q(255,255,255,1),a=t.shift();for(;a;)n.opacity>0&&a.opacity>0?(r=new Q(0,0,0,0),r.blendWith(a,n)):a.opacity>0?r=a:r=n,n=r,a=t.shift();return r}function yr(e){const t=[];let n=e;for(;n.parentElement;){n=n.parentElement;const r=window.getComputedStyle(n).backgroundColor,a=fr(r);if(r&&t.push(a),a.opacity===1)break}try{return mr(t.reverse())}catch(r){return f.notify(new Error("[BackgroundDetection] Failed to blend colors for element ".concat(e.outerHTML))),new Q(255,255,255,1)}}function fr(e){try{const t=e.split("(")[1].split(")")[0].replace(" ","").split(",");return new Q(Number(t[0]),Number(t[1]),Number(t[2]),typeof t[3]>"u"?1:Number(t[3]))}catch(t){f.notify(new Error("[BackgroundDetection] Failed to convert rgbString to array ".concat(e)))}return new Q(255,255,255,1)}var gr=0;function J(e){return"__private_"+gr+++"_"+e}function S(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}function ne(e){return Object.entries(e).map(([t,n])=>({key:t,value:{stringValue:String(n)}}))}const Xe=1,br=wr(5,2,12);function wr(e,t,n){const r=[0];for(let a=0;a<n;a++){const o=Math.floor(e*t**a);r.push(o)}return r}var et=J("exporter"),L=J("attributes"),T=J("metrics");class Cr{constructor({exporter:t,attributes:n}){Object.defineProperty(this,et,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:[]}),S(this,et)[et]=t,S(this,L)[L]=n!=null?n:{}}addAttributes(t){S(this,L)[L]=y(y({},S(this,L)[L]),t)}histogram({name:t,value:n,unit:r,bounds:a,attributes:o}){const i=Date.now()*1e6;S(this,T)[T].push({name:t,type:"histogram",value:n,unit:r,timeUnixNano:i,attributes:o,bounds:a})}counter({name:t,value:n,unit:r,attributes:a}){const o=Date.now()*1e6;S(this,T)[T].push({name:t,type:"counter",value:n,unit:r,timeUnixNano:o,attributes:a})}gauge({name:t,value:n,unit:r,attributes:a}){const o=Date.now()*1e6;S(this,T)[T].push({name:t,type:"gauge",value:n,unit:r,timeUnixNano:o,attributes:a})}async exportMetrics(){const t={};S(this,T)[T].forEach(r=>{switch(r.attributes=y(y({},S(this,L)[L]),r.attributes),r.type){case"histogram":vr(t,r);break;case"counter":Sr(t,r);break;case"gauge":Er(t,r);break}});const n=Object.values(t);n.length!==0&&(S(this,T)[T]=[],await S(this,et)[et].exportMetrics(n))}}function vr(e,t){var n;const{name:r,value:a,unit:o,timeUnixNano:i,attributes:s}=t,u=(n=t.bounds)!==null&&n!==void 0?n:br,d=new Array(u.length+1).fill(0);e[r]||(e[r]={name:r,unit:o||"1",histogram:{aggregationTemporality:Xe,dataPoints:[]}});for(let l=0;l<d.length;l++){const h=u[l];if(h===void 0)d[l]=1;else if(a<=h){d[l]=1;break}}e[r].histogram.dataPoints.push({startTimeUnixNano:i,timeUnixNano:i,count:1,sum:a,min:a,max:a,bucketCounts:d,explicitBounds:u,attributes:ne(s!=null?s:{})})}function Sr(e,t){const{name:n,value:r,unit:a,timeUnixNano:o,attributes:i}=t;e[n]||(e[n]={name:n,unit:a||"1",sum:{aggregationTemporality:Xe,isMonotonic:!0,dataPoints:[]}}),e[n].sum.dataPoints.push({startTimeUnixNano:o,timeUnixNano:o,asDouble:r,attributes:ne(i!=null?i:{})})}function Er(e,t){const{name:n,value:r,unit:a,timeUnixNano:o,attributes:i}=t;e[n]||(e[n]={name:n,unit:a||"1",gauge:{dataPoints:[]}}),e[n].gauge.dataPoints.push({startTimeUnixNano:o,timeUnixNano:o,asDouble:r,attributes:ne(i!=null?i:{})})}var nt=J("url"),rt=J("serviceName"),ot=J("logger");class Ar{constructor(t,n,r){Object.defineProperty(this,nt,{writable:!0,value:void 0}),Object.defineProperty(this,rt,{writable:!0,value:void 0}),Object.defineProperty(this,ot,{writable:!0,value:void 0}),S(this,nt)[nt]=t,S(this,rt)[rt]=n,S(this,ot)[ot]=r==null?void 0:r.logger}async exportMetrics(t){var n;const r={resourceMetrics:[{resource:{attributes:[{key:"service.name",value:{stringValue:S(this,rt)[rt]}}]},scopeMetrics:[{scope:{name:"open-telemetry-mini-client",version:"0.3.3",attributes:[]},metrics:t}]}]},a=await fetch(S(this,nt)[nt],{method:"POST",keepalive:!0,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if((n=S(this,ot)[ot])===null||n===void 0||n.log({status:a.status}),!a.ok){if(a.status===400){const o=await a.text();throw new gt("Invalid OpenTelemetry Metrics: ".concat(o))}if(a.status===429||a.status===503){const o=await a.json(),i=a.headers.get("Retry-After"),s=i?{seconds:Number(i)}:void 0;throw new gt("Server did not accept metrics",{errorData:o,retryAfter:s,metrics:t})}throw new gt("Server responded with ".concat(a.status))}}}class gt extends Error{constructor(t,n){super(t),this.metadata=void 0,this.name="OpenTelemetryClientError",this.metadata=n}}const Pr="https://otlp-http-production.shopifysvc.com/v1/metrics",_r="portable_wallets";class Ir{constructor(t){this.exporter=t}async exportMetrics(t){var n;try{await this.exporter.exportMetrics(t)}catch(r){if(r instanceof gt){const a=(n=r.metadata)==null?void 0:n.retryAfter;if(a){await new Promise(o=>{setTimeout(()=>{this.exportMetrics(t),o()},a.seconds*1e3)});return}}throw r}}}const Tr=new Ar(Pr,_r),kr=new Ir(Tr),k=new Cr({exporter:kr});class V extends Je{constructor(){super(),c(this,"i18n"),c(this,"dataSource"),c(this,"apiClient"),c(this,"classNames"),c(this,"onRendered"),c(this,"setI18n"),c(this,"setDataSource"),c(this,"setApiClient"),c(this,"setClassNames"),c(this,"parsedWalletParams"),this.onRendered=()=>{},[this.i18n,this.setI18n]=this.createResolvablePromise(),[this.dataSource,this.setDataSource]=this.createResolvablePromise(),[this.apiClient,this.setApiClient]=this.createResolvablePromise(),[this.classNames,this.setClassNames]=this.createResolvablePromise()}attributeChangedCallback(t,n,r,a){n!==r&&t==="disabled"&&a&&(r?a.setAttribute("aria-disabled","true"):a.removeAttribute("aria-disabled"))}createResolvablePromise(){let t;return[new Promise(n=>t=n),t]}get pageType(){return this.getAttribute("page-type")}get buttonTheme(){return yr(this).isDark()?"LIGHT":"DARK"}get walletParams(){var t;if(this.parsedWalletParams===void 0)try{this.parsedWalletParams=JSON.parse((t=this.getAttribute("wallet-params"))!=null?t:"{}")}catch(n){throw new Error("Error while parsing wallet-params JSON: ".concat(n))}return this.parsedWalletParams}redirectToCheckout(t){k.exportMetrics(),window.location.assign(t)}}const Nr="#more-payment-options-link{cursor:pointer}";var g=(e=>(e.InvalidLanguage="Variable $language of type LanguageCode was provided invalid value",e.InvalidCountry="Variable $country of type CountryCode was provided invalid value",e.MissingCartId="Variable $cartId of type ID! was provided invalid value",e.BuyerIdentityInvalidCountry="Variable $buyerIdentity of type CartBuyerIdentityInput! was provided invalid value for countryCode",e.BuyerIdentityInvalidPhone="INVALID: buyerIdentity.phone",e.BuyerIdentityEmailRequired="BUYER_IDENTITY_EMAIL_REQUIRED",e.DeliveryFirstNameInvalid="DELIVERY_FIRST_NAME_INVALID",e.DeliveryFirstNameRequired="DELIVERY_FIRST_NAME_REQUIRED",e.DeliveryLastNameInvalid="DELIVERY_LAST_NAME_INVALID",e.DeliveryLastNameRequired="DELIVERY_LAST_NAME_REQUIRED",e.DeliveryAddress1Required="DELIVERY_ADDRESS1_REQUIRED",e.DeliveryAddress1Invalid="DELIVERY_ADDRESS1_INVALID",e.DeliveryAddress2Required="DELIVERY_ADDRESS2_REQUIRED",e.DeliveryAddress2Invalid="DELIVERY_ADDRESS2_INVALID",e.DeliveryCityRequired="DELIVERY_CITY_REQUIRED",e.DeliveryCityInvalid="DELIVERY_CITY_INVALID",e.DeliveryZoneNotFound="DELIVERY_ZONE_NOT_FOUND",e.DeliveryZoneRequiredForCountry="DELIVERY_ZONE_REQUIRED_FOR_COUNTRY",e.DeliveryPostalCodeInvalid="DELIVERY_POSTAL_CODE_INVALID",e.DeliveryInvalidPostalCodeForZone="DELIVERY_INVALID_POSTAL_CODE_FOR_ZONE",e.DeliveryInvalidPostalCodeForCountry="DELIVERY_INVALID_POSTAL_CODE_FOR_COUNTRY",e.DeliveryPostalCodeRequired="DELIVERY_POSTAL_CODE_REQUIRED",e.DeliveryCountryInvalid="INVALID: buyerIdentity.deliveryAddressPreferences.0.deliveryAddress.country",e.DeliveryPhoneNumberRequired="DELIVERY_PHONE_NUMBER_REQUIRED",e.DeliveryPhoneNumberInvalid="DELIVERY_PHONE_NUMBER_INVALID",e.MerchandiseOutOfStock="MERCHANDISE_OUT_OF_STOCK",e.InvalidQuantity="INVALID: input.lines.0.quantity",e.UnacceptablePaymentsAmount="PAYMENTS_UNACCEPTABLE_PAYMENT_AMOUNT",e.DeliveryNotAvailable="DELIVERY_NO_DELIVERY_AVAILABLE",e.PendingDeliveryGroups="PENDING_DELIVERY_GROUPS",e.InvalidPaymentAmount="INVALID_PAYMENT: payment.amount",e))(g||{});const Dr="https://monorail-edge.shopifysvc.com",Rr="/v1/produce";function xr(){if(typeof crypto<"u"&&crypto&&typeof crypto.randomUUID=="function")return crypto.randomUUID();const e=new Array(36);for(let t=0;t<36;t++)e[t]=Math.floor(Math.random()*16);return e[14]=4,e[19]=e[19]&=-5,e[19]=e[19]|=8,e[8]=e[13]=e[18]=e[23]="-",e.map(t=>t.toString(16)).join("")}function Lr(e){const t={"Content-Type":"application/json; charset=utf-8","X-Monorail-Edge-Event-Created-At-Ms":(e&&e.eventCreatedAtMs||Date.now()).toString(),"X-Monorail-Edge-Event-Sent-At-Ms":Date.now().toString(),"X-Monorail-Edge-Client-Message-Id":(e&&e.clientMessageId||xr()).toString()};return e&&e.userAgent&&(t["User-Agent"]=e.userAgent),e&&e.remoteIp&&(t["X-Forwarded-For"]=e.remoteIp),t}async function Or({endpoint:e,event:t,keepalive:n}){return fetch(e!=null?e:Dr+Rr,{method:"post",headers:Lr(t.metadata),body:JSON.stringify({schema_id:t.schemaId,payload:t.payload}),keepalive:n})}var q=(e=>(e.InitCompleted="portable_wallets_init_completed",e.InstrumentLoadTime="portable_wallets_instrument_load_time",e.MonorailProduceError="portable_wallets_monorail_produce_error",e.SheetClicked="portable_wallets_sheet_clicked",e.SheetCancelled="portable_wallets_sheet_cancelled",e.SheetSuccess="portable_wallets_sheet_success",e.Decelerated="portable_wallets_decelerated",e))(q||{});const $r=["Chrome-Lighthouse"];function Mr(){const e=navigator.userAgent;return $r.some(t=>e.includes(t))}async function Ur(e){if(Mr())return;f.leaveBreadcrumb("monorail event produced to ".concat(e.schemaId),e);let t;try{t=await Or({event:e})}catch(n){}t!=null&&t.ok||k.counter({name:q.MonorailProduceError,value:1,attributes:{schemaId:e.schemaId}})}const ke="shopify_wallet_checkout_track/6.1";async function U(e){var t,n,r,a,o,i,s,u,d,l,h,b;(n=(t=window==null?void 0:window.ShopifyAnalytics)==null?void 0:t.lib)!=null&&n.trekkie||await new Promise(Ce=>{const Ae=setInterval(()=>{var Se,Ee;(Ee=(Se=window==null?void 0:window.ShopifyAnalytics)==null?void 0:Se.lib)!=null&&Ee.trekkie&&(clearInterval(Ae),Ce())},100),Wa=setTimeout(()=>{clearInterval(Ae),clearTimeout(Wa),Ce()},7e3)});const p=(o=(a=(r=window.ShopifyAnalytics)==null?void 0:r.lib)==null?void 0:a.trekkie)==null?void 0:o.defaultAttributes,C={uniqToken:(i=p==null?void 0:p.uniqToken)!=null?i:"",visitToken:(s=p==null?void 0:p.visitToken)!=null?s:"",microSessionId:(u=p==null?void 0:p.microSessionId)!=null?u:"",microSessionCount:(d=p==null?void 0:p.microSessionCount)!=null?d:0,shopId:(l=p==null?void 0:p.shopId)!=null?l:0,themeId:p==null?void 0:p.themeId,themeCityHash:(h=p==null?void 0:p.themeCityHash)!=null?h:"",contentLanguage:(b=p==null?void 0:p.contentLanguage)!=null?b:"",referer:p==null?void 0:p.referer},{uniqToken:w,visitToken:E,microSessionId:W,microSessionCount:pe,shopId:ye,themeId:z,themeCityHash:de,contentLanguage:me,referer:ue}=C,{event:he,eventSubtype:Fa,checkoutToken:qa,instrumentId:ja,ttl:za}=e,ve={schemaId:ke,payload:{event:he,event_subtype:Fa,checkout_token:qa,app_name:"storefront",page_type:cr(),instrument_id:ja,ttl:za,uniq_token:w,visit_token:E,micro_session_id:W,micro_session_count:pe,shop_id:ye,theme_id:z,theme_city_hash:de,content_language:me,referer:ue,checkout_one:!0}};if(!he){f.notify(new Error("Event is required"),{metadata:{request:{monorail:{schemaId:ke,payload:JSON.stringify(ve)}}}});return}await Ur(ve)}var m=(e=>(e.BuyItNow="BuyItNow",e.MoreOptions="MoreOptions",e.ApplePay="ApplePay",e.PayPal="PayPalV5",e.Venmo="Venmo",e.GooglePay="GooglePay",e.ShopPay="ShopifyPay",e.MetaPay="FacebookPay",e.BuyWithPrime="BuyWithPrime",e.AmazonPay="AmazonPay",e))(m||{}),I=(e=>(e.CartInitCalled="portable_wallets_cart_init_called",e.ClickSheetCancelled="portable_wallets_instrument_click_sheet_cancelled",e.ClickSheetFailed="portable_wallets_instrument_click_sheet_failure",e.ClickSheetSuccess="portable_wallets_instrument_click_sheet_success",e.InitCalled="portable_wallets_init_called",e.InitFailed="portable_wallets_init_failed",e.InitSuccess="portable_wallets_init_success",e.UpdateFailed="portable_wallets_instrument_update_failed",e.InstrumentLoaded="portable_wallets_instrument_loaded",e))(I||{});function Fr(e){const t=n=>{n.persisted&&(e(),window.removeEventListener("pageshow",t))};window.addEventListener("pageshow",t)}function Br(){U({event:I.InitCalled})}function qr({result:e,eventType:t}){var n,r;k.counter({name:q.InitCompleted,value:1,attributes:{result:e,eventType:t,recoveredFailure:!!((r=(n=window.Shopify)==null?void 0:n.PaymentButton)!=null&&r.failedToLoad)}}),U({event:e==="success"?I.InitSuccess:I.InitFailed,eventSubtype:t})}function Wr({instrument:e,measurement:t}){t!=null&&k.histogram({name:q.InstrumentLoadTime,value:t,attributes:{instrument:e},unit:"ms"}),U({event:I.InstrumentLoaded,instrumentId:e,ttl:t})}function Vr({instrument:e,result:t,checkoutToken:n}){k.counter({name:q.SheetClicked,value:1,attributes:{instrument:e,result:t}}),U({event:t==="success"?I.ClickSheetSuccess:I.ClickSheetFailed,checkoutToken:n,instrumentId:e})}function zr(e,t){U({event:"".concat(I.UpdateFailed,"-").concat(t),instrumentId:e})}function jr(e){k.counter({name:q.SheetCancelled,value:1,attributes:{instrument:e}}),U({event:I.ClickSheetCancelled,instrumentId:e})}function Hr(e){k.counter({name:q.SheetSuccess,value:1,attributes:{instrument:e}}),k.exportMetrics(),U({event:I.ClickSheetSuccess,instrumentId:e})}function Kr({instrument:e,reason:t}){k.counter({name:q.Decelerated,value:1,attributes:{instrument:e,reason:t}})}function Gr(){window.setInterval(()=>{k.exportMetrics()},1e3)}const v={initStarted:O(Br),initCompleted:O(qr),instrumentLoaded:O(Wr),sheetClicked:O(Vr),updateFailed:O(zr),sheetCancelled:O(jr),sheetSuccess:O(Hr),startExporter:O(Gr),decelerated:O(Kr)};function O(e){return(...t)=>{try{e(...t)}catch(n){f.notify(n)}}}class Yr extends Error{constructor(t){super("[".concat(t.name,"] ").concat(t.message)),this.stack=t.stack,this.name="HandleCreateCartError"}}async function X({element:e,instrumentName:t,dataSource:n,sendTelemetryOnError:r=!0,willHandleErrorCodes:a}){try{const o=await n.getCart(),{cart:i,errors:s}=o;if(Fr(()=>{e&&(e.disabled=!1)}),!i||!i.id)throw new Error("[".concat(t,"] received invalid cart"));if(!i.checkoutUrl)throw new Error("[".concat(t,"] Created cart with no checkout URL"));if(s.length>0&&!(a!=null&&a(s)))throw new Error("Failed to create cart: ".concat(JSON.stringify(s)));return o}catch(o){throw r&&v.sheetClicked({instrument:t,result:"failed"}),e.disabled=!1,new Yr(o)}}class Qr extends V{constructor(){super(...arguments),c(this,"anchor")}static get observedAttributes(){return["disabled"]}async connectedCallback(){this.render()}attributeChangedCallback(t,n,r){n!==r&&t==="disabled"&&this.anchor&&(r?this.anchor.setAttribute("disabled","true"):this.anchor.removeAttribute("disabled"))}async handleClick(t){if(t.preventDefault(),this.disabled||!this.anchor||this.anchor.getAttribute("disabled"))return;this.disabled=!0;const[n,r]=await Promise.all([this.i18n,this.dataSource]);try{const{cart:a}=await X({element:this,instrumentName:m.MoreOptions,dataSource:r,willHandleErrorCodes(o){return o.length===1&&o[0]===g.InvalidQuantity}});this.redirectToCheckout(a.checkoutUrl)}catch(a){f.notify(a),pt(n.translate("error_dialogs.checkout.title"),n.translate("error_dialogs.checkout.generic_error"))}}async render(){const t=await this.i18n,n=await this.classNames;this.anchor=dr(),this.anchor.textContent=t.translate("more_payment_options"),this.anchor.className=n,this.anchor.setAttribute("id","more-payment-options-link"),this.disabled&&this.anchor.setAttribute("disabled","true"),this.anchor.onclick=a=>this.handleClick(a),this.appendChild(this.anchor);const r=document.createElement("style");r.textContent=Nr,this.appendChild(r)}}const Jr="#buyer-consent{margin-top:1em}#buyer-consent-link{background:none;border:none;padding:0;text-decoration:underline;font-size:inherit}";class re extends HTMLElement{constructor(t,n){super(),c(this,"i18n"),c(this,"apiClient"),this.apiClient=t,this.i18n=n}async connectedCallback(){this.render()}async render(){const t=document.createElement("p");t.setAttribute("id","buyer-consent");const n=new Ze(this.apiClient,this.i18n);t.innerHTML=this.i18n.translate("subscriptions.buyer_consent",{subscriptionPolicyLink:'<span id="subscription-policy-link"></span>'}),t.querySelector("#subscription-policy-link").appendChild(n);const r=document.createElement("style");r.textContent=Jr;const a=new DocumentFragment;a.appendChild(r),a.appendChild(t),this.appendChild(a)}}class Ze extends HTMLElement{constructor(t,n){super(),c(this,"isFetchingPolicy",!1),c(this,"policy"),c(this,"i18n"),c(this,"apiClient"),this.i18n=n,this.apiClient=t}async connectedCallback(){this.render()}async render(){const t=Nt();t.setAttribute("id","buyer-consent-link"),t.textContent=this.i18n.translate("subscriptions.cancellation_policy"),t.onclick=this.onClick.bind(this),this.appendChild(t)}async onClick(t){if(t.preventDefault(),!this.isFetchingPolicy){if(this.policy){this.showPolicy(this.policy);return}try{await this.fetchSubscriptionPolicy();const n=this.policy&&this.policy!==""?this.policy:this.i18n.translate("subscriptions.policy_not_found");this.showPolicy(n)}catch(n){f.notify(n),this.showPolicy(this.i18n.translate("subscriptions.policy_not_found"))}}}async fetchSubscriptionPolicy(){this.isFetchingPolicy=!0,this.policy=await this.apiClient.fetchSubscriptionPolicy(),this.isFetchingPolicy=!1}showPolicy(t){hr(this.i18n.translate("subscriptions.subscription_policy"),t)}}R("buyer-consent-link",Ze,{isChildCustomElement:!0});class Xr extends Error{constructor({code:t,message:n}){super(n),c(this,"name","DeveloperError"),c(this,"code","unknown"),this.code=t}}class Zr extends Error{constructor({message:t}){super(t),c(this,"name","SilencedError")}}class to extends Error{constructor(){super(...arguments),c(this,"name","MissingConfigError")}}class oe extends Je{get shopId(){return this.getAttribute("shop-id")}get cartId(){return this.getAttribute("cart-id")}get walletConfigs(){return this.getAttribute("wallet-configs")}get variantParams(){var t;try{return JSON.parse((t=this.getAttribute("variant-params"))!=null?t:"[]")}catch(n){throw new Xr({code:"invalid-variant-params",message:"variant-params must be a valid JSON string"})}}triggerLoadedEvent(){document.dispatchEvent(new Event("shopify:payment_button:loaded",{bubbles:!0,cancelable:!0}))}toggleBuyerConsent(t,n,r){if(this.hasSellingPlan){const o=new re(n,r);t.appendChild(o);return}const a=document.querySelector("#buyer-consent");a&&t.contains(a)&&a.remove()}}R("buyer-consent",re,{isChildCustomElement:!0});const at=Element.prototype,eo="once";function Ne(e){const t=ae(e);return tn(t)}function tn(e){var t;const n=e==null?void 0:e.elements;if(!n)return null;const r=bt(n,"id");if(!r||isNaN(Number(r)))return null;const a=Number((t=bt(n,"quantity"))!=null?t:"1"),o="gid://shopify/ProductVariant/".concat(r),i=bt(n,"selling_plan"),s=i?"gid://shopify/SellingPlan/".concat(i):void 0,u=ro(e);return{variantId:r,quantity:a,merchandiseId:o,sellingPlanId:s,lineItemProperties:u}}function ae(e){const t=De(e,"[data-shopify='payment-button']")||document.querySelector("[data-shopify='payment-button']");return De(t,"form")}function no(e){const t=e==null?void 0:e.elements;if(!t)return!1;const n=bt(t,"sellingPlan-Group");return!!(n&&n!==eo)}function ro(e){if(!e)return{};const t=document.querySelectorAll('[name^="properties"][form^="'.concat(CSS.escape(e.getAttribute("id")||""),'"]')),n=e.querySelectorAll('[name^="properties"]'),r=[...t,...n],a={};return r.forEach(o=>{const i=oo(o),s=ao(o);i&&typeof s<"u"&&(a[i]=s)}),a}function oo(e){const t=e.getAttribute("name");if(t===null)return null;const n=t.indexOf("["),r=t.lastIndexOf("]");return n===-1||r===-1?null:t.substring(n+1,r)}function ao(e){if(!(["radio","checkbox"].includes(e.type)&&!e.checked)&&!(e.value===""||typeof e.value>"u"))return e.value}function bt(e,t){var n;const r=e.namedItem(t);return r&&"value"in r&&(n=r.value)!=null?n:null}function De(e,t){if(at.matches=at.matches||at.webkitMatchesSelector||at.msMatchesSelector||at.mozMatchesSelector,!e||e.matches(t))return e;let n=e;for(;n&&n!==document.body;)if(n=n.parentElement,n&&n.matches(t))return n;return null}class io{constructor(t,n,r){c(this,"addToCartMutationObserver"),c(this,"addToCartForm"),c(this,"addToCartButtons"),this.element=t,this.setComponentDisabled=n,this.setSubscriptionRequirement=r,this.addToCartMutationObserver=null,this.addToCartForm=null,this.addToCartButtons=[]}setupMutationObservers(){if(this.findAndSetAddToCartButtons(),!this.addToCartForm)return;this.syncComponentStateWithForm();const t=new MutationObserver(()=>this.reobserveOnFormChanges());this.addToCartMutationObserver=new MutationObserver(()=>this.syncComponentStateWithForm()),t.observe(this.addToCartForm,{childList:!0}),this.observeAddToCartButtons()}syncComponentStateWithForm(){if(!this.addToCartForm){this.setComponentDisabled(!0);return}const t=tn(this.addToCartForm),n=!!(this.addToCartButtons.length>0&&this.addToCartButtons.every(a=>a.disabled));this.setComponentDisabled(n||t===null);const r=no(this.addToCartForm);this.setSubscriptionRequirement(r)}observeAddToCartButtons(){this.addToCartButtons.forEach(t=>{this.addToCartMutationObserver.observe(t,{attributes:!0})})}reobserveOnFormChanges(){var t;(t=this.addToCartMutationObserver)==null||t.disconnect(),this.findAndSetAddToCartButtons(),this.observeAddToCartButtons(),this.syncComponentStateWithForm()}findAndSetAddToCartButtons(){this.addToCartForm=ae(this.element),this.addToCartForm&&(this.addToCartButtons=[...this.addToCartForm.querySelectorAll("[type=submit]")])}}class so extends V{constructor(){super(...arguments),c(this,"button",null),c(this,"buyNowText","")}static get observedAttributes(){return["disabled"]}async connectedCallback(){this.buyNowText=(await this.i18n).translate("instruments_copy.checkout.buy_now"),this.render()}attributeChangedCallback(t,n,r){super.attributeChangedCallback(t,n,r,this.button)}async handleClick(){if(this.disabled||!this.button||this.button.getAttribute("aria-disabled"))return;this.disabled=!0;const[t,n]=await Promise.all([this.i18n,this.dataSource]);try{const{cart:r}=await X({element:this,instrumentName:m.BuyItNow,dataSource:n,willHandleErrorCodes(a){return a.length===1&&a[0]===g.InvalidQuantity}});v.sheetClicked({instrument:m.BuyItNow,checkoutToken:te(r),result:"success"}),this.redirectToCheckout(r.checkoutUrl)}catch(r){f.notify(r),pt(t.translate("error_dialogs.checkout.title"),t.translate("error_dialogs.checkout.generic_error"))}}async render(){var t;this.button||(this.button=Nt());const n=await this.classNames;this.button.textContent=this.buyNowText,this.button.className=n,this.disabled&&this.button.setAttribute("aria-disabled","true"),this.button.onclick=()=>this.handleClick(),this.appendChild(this.button),(t=this.onRendered)==null||t.call(this)}}function lo(){const e=navigator.userAgent,t=e.indexOf("Android")>-1,n=e.indexOf("Chrome/")>-1,r=parseInt((/Chrome\/([0-9]+)/.exec(e)||["0","0"])[1],10);return t&&n&&r===114}class Z{constructor(t){c(this,"walletParams"),this.walletParams=t.wallet_params}static walletName(){throw new Error("Must define walletName for WalletInstrument subclass")}createWebComponent({accessToken:t,country:n,disabled:r="false",dataSource:a,i18n:o,apiClient:i,currency:s,classNames:u="",callToAction:d,pageType:l=_.ProductPage}){var h;const b=this.getWebComponentName();R(b,this.getWebComponentClass(),{isChildCustomElement:!0});const p=document.createElement(b),C={"access-token":t,"buyer-country":n,"buyer-currency":s,disabled:r,"wallet-params":JSON.stringify((h=this.walletParams)!=null?h:{}),"page-type":l};try{for(const[w,E]of Object.entries(C))w&&p.setAttribute(w,E||"")}catch(w){const E=w;throw E.message.includes("setAttribute is not a function")&&lo()?new Zr({message:E.message}):E}return d&&p.setAttribute("call-to-action",""),p.setDataSource(a),p.setApiClient(i),p.setI18n(o),p.setClassNames(u),p}loadWalletSDK(){return Promise.resolve()}getLoadEligibility(){return{eligible:!0}}getPartnerSDKEligibility(){return{eligible:!0}}}class co extends Z{static walletName(){return"buy_it_now"}getWebComponentName(){return"shopify-buy-it-now-button"}getInstrumentName(){return m.BuyItNow}getWebComponentClass(){return so}}async function wt(e){const{cartClient:t,instrumentName:n}=e;try{if(!e.cartId)throw new Error("[".concat(n,"] provided no cart ID when updating buyer identity"));if(!t)throw new Error("[".concat(n,"] provided invalid cart client when updating buyer identity"));return await t.updateCartBuyerIdentity(e)}catch(r){throw v.updateFailed(n,"updateBuyerIdentity"),r}}async function en({cartId:e,totalAmount:t,paymentMethod:n,billingAddress:r,cartClient:a,instrumentName:o,abortSignal:i,hasSellingPlan:s}){try{if(!e)throw new Error("[".concat(o,"] provided no cart ID when updating payment"));if(!t)throw new Error("[".concat(o,"] provided no total amount when updating payment"));if(!n)throw new Error("[".concat(o,"] provided no apple pay wallet content when updating payment"));if(!a)throw new Error("[".concat(o,"] provided invalid cart client when updating payment"));const u={freePaymentMethod:{billingAddress:r}};return await a.updateCartPayment(e,y({amount:{amount:t.amount,currencyCode:t.currencyCode}},Number(t.amount)<=0&&!s?u:n),i)}catch(u){throw v.updateFailed(o,"updatePayment"),u}}const Re=44;class uo extends V{constructor(){super(),c(this,"abortController"),c(this,"cart",null),c(this,"sdkButtonsComponent"),this.abortController=typeof AbortController=="function"&&new AbortController||null}async connectedCallback(){var t,n;const r=this.walletParams.paymentIntent==="TOKENIZE",a=async()=>{try{return await this.createToken(this.apiClient,this.dataSource)}catch(s){f.notify(s);const u=await this.i18n;throw pt(u.translate("error_dialogs.checkout.title"),u.translate("error_dialogs.checkout.generic_error")),s}};let o,i;r?i=a:o=a,this.sdkButtonsComponent=(n=(t=window.paypal).Buttons)==null?void 0:n.call(t,{fundingSource:"paypal",style:{color:"gold",label:this.hasAttribute("call-to-action")?"pay":"paypal",height:Re,shape:"sharp"},createOrder:o,createBillingAgreement:i,onApprove:async s=>{await this.onApprove(s)},onCancel:()=>{var s;v.sheetCancelled(m.PayPal),(s=this.abortController)==null||s.abort(),this.disconnectedCallback()}}),this.render()}disconnectedCallback(){this.sdkButtonsComponent&&this.sdkButtonsComponent.close()}render(){var t;this.setAttribute("style","display: block; height: ".concat(Re,"px;")),(t=this.sdkButtonsComponent)==null||t.render(this)}async createToken(t,n){const r=await t,a=await n;this.cart=null;try{const{cart:o}=await X({element:this,instrumentName:m.PayPal,dataSource:a}),i=await r.payPalTokenCreate(o.id);return this.cart=o,i}finally{v.sheetClicked({instrument:m.PayPal,result:this.cart?"success":"failed"})}}async onApprove({orderID:t,payerID:n}){var r,a,o;if(!this.cart)throw new Error("Cart not found");const i=await this.apiClient,s=await i.payPalBuyerDetailsFetch(t);await Promise.all([wt({cartId:this.cart.id,cartClient:i,instrumentName:m.PayPal,emailAddress:s.email,streetAddress:s.destinationAddress}),en({abortSignal:(r=this.abortController)==null?void 0:r.signal,cartClient:i,cartId:this.cart.id,instrumentName:m.PayPal,billingAddress:(a=s.billingAddress)!=null?a:s.destinationAddress,paymentMethod:{walletPaymentMethod:{paypalWalletContent:{billingAddress:(o=s.billingAddress)!=null?o:s.destinationAddress,email:s.email,expiresAt:s.expiresAt,payerId:n,token:t,acceptedSubscriptionTerms:!1,vaultingAgreement:!1}}},totalAmount:this.cart.totalAmount})]),v.sheetSuccess(m.PayPal),this.redirectToCheckout(this.cart.checkoutUrl)}}class ho extends Z{static walletName(){return"paypal"}constructor(t){super(t)}getWebComponentName(){return"shopify-paypal-button"}getInstrumentName(){return m.PayPal}getWebComponentClass(){return uo}loadWalletSDK(){const t=document.createElement("script");return t.setAttribute("src",this.walletParams.sdkUrl),new Promise((n,r)=>{t.onload=()=>n(),t.onerror=a=>{document.body.removeChild(t),r(a)},document.body.appendChild(t)})}getLoadEligibility(){return{eligible:!0}}getPartnerSDKEligibility(){var t,n;return(n=(t=window==null?void 0:window.paypal)==null?void 0:t.Buttons)!=null&&n.call(t).isEligible()?{eligible:!0}:{eligible:!1,reason:"failed PayPal SDK eligibility check"}}}const po=".apple-pay-button{width:100%;padding:0!important;cursor:pointer;border:none;align-items:center}.apple-pay-button:hover:not(:disabled){filter:brightness(92%)}.apple-pay-button svg{height:100%;flex-shrink:0}.apple-pay--content{width:100%;height:100%;display:flex;align-items:center;justify-content:center;white-space:pre}.apple-pay--light{background:#fff;color:#000}.apple-pay--light svg{fill:#000}.apple-pay--dark{background:#000;color:#fff}.apple-pay--dark svg{fill:#fff}",zt={UK:"GB",JA:"JP"},nn=["AS","GU","MP","PR","VI"];nn.forEach(e=>{zt[e]="US"});function ft(e){var t,n;const r=e.countryCode,a={firstName:e.givenName||void 0,lastName:e.familyName||void 0,address1:(t=e==null?void 0:e.addressLines)==null?void 0:t[0],address2:((n=e==null?void 0:e.addressLines)==null?void 0:n[1])||void 0,city:e.locality||void 0,zip:e.postalCode||void 0,province:e.administrativeArea||e.subLocality||void 0,country:mo(e.countryCode),phone:e.phoneNumber||void 0};return a.country==="HK"&&(a.zip=void 0,a.province=e.postalCode),r&&nn.includes(r)&&(a.province=r),a.lastName||(a.lastName=a.firstName),a}function mo(e){if(!e)return"ZZ";const t=e.toUpperCase();return Object.keys(zt).includes(t)?zt[t]:t}function yo(e,t){return K({label:e,possibleLines:[t]})[0]}function fo({subtotal:e,deliveryGroups:t,duties:n,taxes:r,discountAllocations:a,i18n:o,formattedRecurringTotals:i}){var s;const u=K({label:o.translate("order_summary.subtotal"),possibleLines:[e]}),d=go(t,o),l=K({label:o.translate("order_summary.duties"),possibleLines:[n]}),h=K({label:o.translate("order_summary.taxes"),possibleLines:[r]}),b=i.map(w=>({label:w,amount:"0.00",type:"pending"})),p=b.length?[{label:o.translate("order_summary.subscriptions.recurring_total_tooltip_line"),amount:"0.00",type:"pending"}]:[],C=(s=a==null?void 0:a.flatMap(w=>{var E;const W=(E=w.title)!=null?E:w.code;return K({label:W!=null?W:o.translate("order_summary.discount"),possibleLines:[w.discountedAmount],isDiscount:!0})}))!=null?s:[];return[...u,...d,...l,...h,...C,...b,...p]}function K({label:e,possibleLines:t,isDiscount:n=!1}){return t.filter(r=>(r==null?void 0:r.amount)!==void 0).map(r=>({label:e,amount:n?"-".concat(Vt(r.amount)):Vt(r.amount)}))}function go(e,t){return e.some(n=>n.groupType===ut.Subscription)?e.map(n=>({label:n.groupType===ut.Subscription?t.translate("order_summary.shipping_subscription"):t.translate("order_summary.shipping_one_time_purchase"),amount:Vt(n.selectedDeliveryOption.estimatedCost.amount)})):K({label:t.translate("order_summary.shipping"),possibleLines:e.map(n=>{var r;return{amount:(r=n.selectedDeliveryOption)==null?void 0:r.estimatedCost.amount}})})}function bo(e,t){return e.map(n=>{var r;return{title:vo(n,t),estimatedCost:{amount:Co(n),currencyCode:n[0].estimatedCost.currencyCode},handle:So(n),description:(r=n[0].description)!=null?r:""}})}function wo(e){return e.map(t=>t.deliveryOptions.map(n=>A(y({},n),{groupType:t.groupType}))).reduce((t,n)=>t.flatMap(r=>n.map(a=>[...r,a])),[[]])}function Co(e){return e.reduce((t,n)=>t+Number(n.estimatedCost.amount),0).toFixed(2)}function vo(e,t){var n,r;const a=(n=e.find(s=>s.groupType===ut.OneTimePurchase))==null?void 0:n.title,o=(r=e.find(s=>s.groupType===ut.Subscription))==null?void 0:r.title,i=[...new Set([a,o])].filter(Boolean);return i.length===2?t.translate("shipping_methods.connect_shipping_methods",{methodOne:i[0],methodTwo:i[1]}):i[0]}function So(e){return e.map(t=>t.handle).join(",")}function Eo(e,t){if(!e.length)return[];const n=wo(e);return bo(n,t).map(r=>{var a;return{label:r.title||"",amount:r.estimatedCost.amount,identifier:r.handle,detail:(a=r.description)!=null?a:""}})}const it=async({paymentSheetAction:e,onProceed:t,terminateSession:n})=>{switch(e.action){case"abort":n();break;case"show_error":await t(e.errors);break;case"update":await t(e.errors);break;default:throw new Error('Missing handler for payment sheet action "'.concat(e.action,'"'))}},Ao=["abort","show_error","complete","update"];class Po{constructor(){c(this,"generatePrioritizedPaymentSheetAction",(t,n)=>{let r;const a=[],o=[],i=[],s=n.filter(d=>d!==g.UnacceptablePaymentsAmount).some(d=>t[d]!==void 0);for(const d of Object.keys(t))if(!(d===g.UnacceptablePaymentsAmount&&s)){const l=t[d]();l.effects&&o.push(...l.effects),l.action!=="complete"&&l.errors&&i.push(...l.errors),a.push(l)}const u=(d=>Ao.map(l=>d.find(h=>h.action===l)).find(l=>!!l))(a);return u&&(r=u,r.effects=o,r.action!=="complete"&&(r.errors=i)),r})}getMergedPaymentSheetAction({result:t,errorActions:n}){const r={};n.forEach(o=>{o.errors.forEach(i=>{t.errors.includes(i)&&(r[i]=o.generateAction)})});let a;for(const o of t.errors){const i=r[o];if(i){a=i();break}}return{firstPaymentSheetAction:a,prioritizedPaymentSheetAction:this.generatePrioritizedPaymentSheetAction(r,t.errors)}}getUnhandledErrors(t,n){const r=n.flatMap(a=>a.errors);return t.filter(a=>!r.includes(a))}}class _o extends Po{constructor(t){super(),this.i18n=t}mapMutationResultToPaymentSheetAction(t,n){var r;const a=this.getErrorActions();if(this.getUnhandledErrors(t.errors,a).forEach(i=>{f.notify(new Error("[".concat(m.ApplePay,"] mutation result error not handled: ").concat(i)))}),((r=t.data)==null?void 0:r.deliveryGroups.length)===0&&n!=null&&n.shippingRequired)return{action:"show_error",errors:[new ApplePayError("addressUnserviceable")]};const{firstPaymentSheetAction:o}=this.getMergedPaymentSheetAction({result:t,errorActions:a});return o||{action:"update",errors:[]}}mapCompletionResultToPaymentSheetAction(t){if(!t.data)throw new Error("[".concat(m.ApplePay,"] completion returned null result"));switch(t.data.__typename){case"SubmitSuccess":return{action:"complete",redirectUrl:t.data.redirectUrl};case"SubmitAlreadyAccepted":case"SubmitThrottled":case"SubmitFailed":{const n=this.getErrorActions();this.getUnhandledErrors(t.errors,n).forEach(a=>{f.notify(new Error("[".concat(m.ApplePay,"] completion result error not handled: ").concat(a)))});const{prioritizedPaymentSheetAction:r}=this.getMergedPaymentSheetAction({result:t,errorActions:n});return r||{action:"abort"}}default:throw new Error("[".concat(m.ApplePay,"] unknown completion result type: ").concat(t.data.__typename))}}getErrorActions(){return[{errors:[g.InvalidLanguage],generateAction:()=>({action:"abort",effects:[()=>{f.notify(new Error("[".concat(m.ApplePay,"] mutation provided invalid language, aborting")))}]})},{errors:[g.InvalidCountry],generateAction:()=>({action:"abort",effects:[()=>{f.notify(new Error("[".concat(m.ApplePay,"] mutation provided invalid country, aborting")))}]})},{errors:[g.MissingCartId],generateAction:()=>({action:"abort",effects:[()=>{f.notify(new Error("[".concat(m.ApplePay,"] mutation provided invalid cart ID, aborting")))}]})},{errors:[g.UnacceptablePaymentsAmount],generateAction:()=>({action:"abort"})},{errors:[g.InvalidPaymentAmount],generateAction:()=>({action:"abort"})},{errors:[g.MerchandiseOutOfStock],generateAction:()=>({action:"abort"})},{errors:[g.DeliveryNotAvailable],generateAction:()=>({action:"show_error",errors:[new ApplePayError("addressUnserviceable")]})},{errors:[g.BuyerIdentityEmailRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","emailAddress",this.i18n.translate("errors.missing.email"))]})},{errors:[g.DeliveryFirstNameRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.missing.first_name"))]})},{errors:[g.DeliveryFirstNameInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.invalid.first_name"))]})},{errors:[g.DeliveryLastNameRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.missing.last_name"))]})},{errors:[g.DeliveryLastNameInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","name",this.i18n.translate("errors.invalid.last_name"))]})},{errors:[g.DeliveryAddress1Required],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.missing.address1"))]})},{errors:[g.DeliveryAddress1Invalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.invalid.address1"))]})},{errors:[g.DeliveryAddress2Required],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.missing.address2"))]})},{errors:[g.DeliveryAddress2Invalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","addressLines",this.i18n.translate("errors.invalid.address2"))]})},{errors:[g.DeliveryCityRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.missing.city"))]})},{errors:[g.DeliveryCityInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","locality",this.i18n.translate("errors.invalid.city"))]})},{errors:[g.DeliveryZoneRequiredForCountry],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","administrativeArea",this.i18n.translate("errors.missing.zone"))]})},{errors:[g.DeliveryZoneNotFound],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","administrativeArea",this.i18n.translate("errors.invalid.zone"))]})},{errors:[g.DeliveryPostalCodeRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","postalCode",this.i18n.translate("errors.missing.postal_code"))]})},{errors:[g.DeliveryPostalCodeInvalid,g.DeliveryInvalidPostalCodeForZone,g.DeliveryInvalidPostalCodeForCountry],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","postalCode",this.i18n.translate("errors.invalid.postal_code"))]})},{errors:[g.DeliveryPhoneNumberRequired],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","phoneNumber",this.i18n.translate("errors.missing.phone"))]})},{errors:[g.DeliveryPhoneNumberInvalid,g.BuyerIdentityInvalidPhone],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","phoneNumber",this.i18n.translate("errors.invalid.phone"))]})},{errors:[g.BuyerIdentityInvalidCountry,g.DeliveryCountryInvalid],generateAction:()=>({action:"show_error",errors:[new ApplePayError("shippingContactInvalid","country",this.i18n.translate("errors.invalid.country"))]})}]}}const xe=["name","postalAddress"];function Io({shippingRequired:e,walletParams:t,buyerCurrency:n}){const{phoneRequired:r,emailRequired:a}=t,o=[...a?["email"]:[],...r?["phone"]:[]],i=e?[...xe,...o]:o;return{countryCode:t.countryCode,currencyCode:n,merchantCapabilities:t.merchantCapabilities,supportedNetworks:t.supportedNetworks,total:{type:"pending",label:t.merchantName,amount:"1.00"},requiredBillingContactFields:xe,requiredShippingContactFields:i,shippingType:t.shippingType}}const To=e=>{const t=e.lineItems.reduce((n,r)=>n+Number(r.subtotalAmount.amount),0);return{amount:String(t),currencyCode:e.totalAmount.currencyCode}},ko=e=>{const t=e.lineItems.flatMap(n=>n.discountAllocations);return[...e.discountCodes.filter(n=>n.applicable&&e.discountAllocations.findIndex(r=>r.code===n.code)===-1&&t.findIndex(r=>r.code===n.code)===-1).map(n=>({code:n.code,discountedAmount:{amount:"0",currencyCode:e.totalAmount.currencyCode}})),...e.discountAllocations,...t]};function No(e,t){return e.reduce((n,r)=>{var a;if(!r.sellingPlanAllocation)return n;const{sellingPlanAllocation:{sellingPlan:o,priceAdjustments:i},quantity:s}=r;if(!o.recurringDeliveries||!o.billingPolicy)return n;const u=Do({billingPolicy:o.billingPolicy,i18n:t}),d=o.priceAdjustments[0].orderCount,l=i[0].price.currencyCode,h=Le({price:Number(i[0].price.amount)*s,currencyCode:l,locale:t.locale});if(i.length===2){const b=i[1].price.currencyCode,p=Le({price:Number((a=i[1])==null?void 0:a.price.amount)*s,currencyCode:b,locale:t.locale});return[...n,t.translate("order_summary.subscriptions.recurring_totals_with_policies",{count:d,fixedPrice:h,recurringPrice:p,interval:u})]}return[...n,t.translate("order_summary.subscriptions.recurring_totals",{fixedPrice:h,interval:u})]},[])}function Le({price:e,currencyCode:t,locale:n}){return Intl.NumberFormat(n,{style:"currency",currency:t,currencyDisplay:"narrowSymbol"}).format(e)}function Do({billingPolicy:e,i18n:t}){const{interval:n,intervalCount:r}=e,a={YEAR:"order_summary.subscriptions.recurring_total_intervals.year",MONTH:"order_summary.subscriptions.recurring_total_intervals.month",WEEK:"order_summary.subscriptions.recurring_total_intervals.week",DAY:"order_summary.subscriptions.recurring_total_intervals.day"}[n];if(!a)throw new Error("Unknown selling plan interval provided: ".concat(n));return t.translate(a,{count:r})}const Dt="GraphQL Client",Oe=0,$e=3,rn="An error occurred while fetching from the API. Review 'graphQLErrors' for details.",on="Response returned unexpected Content-Type:",an="An unknown error has occurred. The API did not return a data object or any errors in its response.",jt={json:"application/json",multipart:"multipart/mixed"},Me="X-SDK-Variant",Ue="X-SDK-Version",Ro="shopify-graphql-client",xo="0.10.3",sn=1e3,Lo=[429,503],ln=/@(defer)\b/i,Fe="\r\n",Oo=/boundary="?([^=";]+)"?/i,Be=Fe+Fe;function B(e,t=Dt){return e.startsWith("".concat(t))?e:"".concat(t,": ").concat(e)}function tt(e){return e instanceof Error?e.message:JSON.stringify(e)}function cn(e){return e instanceof Error&&e.cause?e.cause:void 0}function un(e){return e.flatMap(({errors:t})=>t!=null?t:[])}function dn({client:e,retries:t}){if(t!==void 0&&(typeof t!="number"||t<Oe||t>$e))throw new Error("".concat(e,': The provided "retries" value (').concat(t,") is invalid - it cannot be less than ").concat(Oe," or greater than ").concat($e))}function P(e,t){return t&&(typeof t!="object"||Array.isArray(t)||typeof t=="object"&&Object.keys(t).length>0)?{[e]:t}:{}}function hn(e,t){if(e.length===0)return t;const n={[e.pop()]:t};return e.length===0?n:hn(e,n)}function pn(e,t){return Object.keys(t||{}).reduce((n,r)=>(typeof t[r]=="object"||Array.isArray(t[r]))&&e[r]?(n[r]=pn(e[r],t[r]),n):(n[r]=t[r],n),Array.isArray(e)?[...e]:y({},e))}function mn([e,...t]){return t.reduce(pn,y({},e))}function $o({clientLogger:e,customFetchApi:t=fetch,client:n=Dt,defaultRetryWaitTime:r=sn,retriableCodes:a=Lo}){const o=async(i,s,u)=>{const d=s+1,l=u+1;let h;try{if(h=await t(...i),e({type:"HTTP-Response",content:{requestParams:i,response:h}}),!h.ok&&a.includes(h.status)&&d<=l)throw new Error;return h}catch(b){if(d<=l){const p=h==null?void 0:h.headers.get("Retry-After");return await Mo(p?parseInt(p,10):r),e({type:"HTTP-Retry",content:{requestParams:i,lastResponse:h,retryAttempt:s,maxRetries:u}}),o(i,d,u)}throw new Error(B("".concat(u>0?"Attempted maximum number of ".concat(u," network retries. Last message - "):"").concat(tt(b)),n))}};return o}async function Mo(e){return new Promise(t=>setTimeout(t,e))}function Uo({headers:e,url:t,customFetchApi:n=fetch,retries:r=0,logger:a}){dn({client:Dt,retries:r});const o={headers:e,url:t,retries:r},i=Fo(a),s=$o({customFetchApi:n,clientLogger:i,defaultRetryWaitTime:sn}),u=Bo(s,o),d=qo(u),l=Go(u);return{config:o,fetch:u,request:d,requestStream:l}}function Fo(e){return t=>{e&&e(t)}}async function yn(e){const{errors:t,data:n,extensions:r}=await e.json();return y(y(y({},P("data",n)),P("extensions",r)),t||!n?{errors:A(y({networkStatusCode:e.status,message:B(t?rn:an)},P("graphQLErrors",t)),{response:e})}:{})}function Bo(e,{url:t,headers:n,retries:r}){return async(a,o={})=>{const{variables:i,headers:s,url:u,retries:d}=o,l=JSON.stringify({query:a,variables:i});dn({client:Dt,retries:d});const h=Object.entries(y(y({},n),s)).reduce((p,[C,w])=>(p[C]=Array.isArray(w)?w.join(", "):w.toString(),p),{});!h[Me]&&!h[Ue]&&(h[Me]=Ro,h[Ue]=xo);const b=[u!=null?u:t,{method:"POST",headers:h,body:l}];return e(b,1,d!=null?d:r)}}function qo(e){return async(...t)=>{if(ln.test(t[0]))throw new Error(B("This operation will result in a streamable response - use requestStream() instead."));try{const n=await e(...t),{status:r,statusText:a}=n,o=n.headers.get("content-type")||"";return n.ok?o.includes(jt.json)?yn(n):{errors:{networkStatusCode:r,message:B("".concat(on," ").concat(o)),response:n}}:{errors:{networkStatusCode:r,message:B(a),response:n}}}catch(n){return{errors:{message:tt(n)}}}}}function Wo(e){return H(this,null,function*(){const t=new TextDecoder;if(e.body[Symbol.asyncIterator])try{for(var n=x(e.body),r,a,o;r=!(a=yield new N(n.next())).done;r=!1){const i=a.value;yield t.decode(i)}}catch(i){o=[i]}finally{try{r&&(a=n.return)&&(yield new N(a.call(n)))}finally{if(o)throw o[0]}}else{const i=e.body.getReader();let s;try{for(;!(s=yield new N(i.read())).done;)yield t.decode(s.value)}finally{i.cancel()}}})}function Vo(e,t){return{[Symbol.asyncIterator](){return H(this,null,function*(){try{let i="";try{for(var n=x(e),r,a,o;r=!(a=yield new N(n.next())).done;r=!1){const s=a.value;if(i+=s,i.indexOf(t)>-1){const u=i.lastIndexOf(t),d=i.slice(0,u).split(t).filter(l=>l.trim().length>0).map(l=>l.slice(l.indexOf(Be)+Be.length).trim());d.length>0&&(yield d),i=i.slice(u+t.length),i.trim()==="--"&&(i="")}}}catch(s){o=[s]}finally{try{r&&(a=n.return)&&(yield new N(a.call(n)))}finally{if(o)throw o[0]}}}catch(i){throw new Error("Error occured while processing stream payload - ".concat(tt(i)))}})}}}function zo(e){return{[Symbol.asyncIterator](){return H(this,null,function*(){const t=yield new N(yn(e));yield A(y({},t),{hasNext:!1})})}}}function jo(e){return e.map(t=>{try{return JSON.parse(t)}catch(n){throw new Error("Error in parsing multipart response - ".concat(tt(n)))}}).map(t=>{const{data:n,incremental:r,hasNext:a,extensions:o,errors:i}=t;if(!r)return A(y(y({data:n||{}},P("errors",i)),P("extensions",o)),{hasNext:a});const s=r.map(({data:u,path:d,errors:l})=>y({data:u&&d?hn(d,u):{}},P("errors",l)));return A(y({data:s.length===1?s[0].data:mn([...s.map(({data:u})=>u)])},P("errors",un(s))),{hasNext:a})})}function Ho(e,t){if(e.length>0)throw new Error(rn,{cause:{graphQLErrors:e}});if(Object.keys(t).length===0)throw new Error(an)}function Ko(e,t){var n;const r=(t!=null?t:"").match(Oo),a="--".concat(r?r[1]:"-");if(!((n=e.body)!=null&&n.getReader)&&!e.body[Symbol.asyncIterator])throw new Error("API multipart response did not return an iterable body",{cause:e});const o=Wo(e);let i={},s;return{[Symbol.asyncIterator](){return H(this,null,function*(){var u,d;try{let C=!0;try{for(var l=x(Vo(o,a)),h,b,p;h=!(b=yield new N(l.next())).done;h=!1){const w=b.value,E=jo(w);s=(d=(u=E.find(pe=>pe.extensions))==null?void 0:u.extensions)!=null?d:s;const W=un(E);i=mn([i,...E.map(({data:pe})=>pe)]),C=E.slice(-1)[0].hasNext,Ho(W,i),yield A(y(y({},P("data",i)),P("extensions",s)),{hasNext:C})}}catch(w){p=[w]}finally{try{h&&(b=l.return)&&(yield new N(b.call(l)))}finally{if(p)throw p[0]}}if(C)throw new Error("Response stream terminated unexpectedly")}catch(C){const w=cn(C);yield A(y(y({},P("data",i)),P("extensions",s)),{errors:A(y({message:B(tt(C)),networkStatusCode:e.status},P("graphQLErrors",w==null?void 0:w.graphQLErrors)),{response:e}),hasNext:!1})}})}}}function Go(e){return async(...t)=>{if(!ln.test(t[0]))throw new Error(B("This operation does not result in a streamable response - use request() instead."));try{const n=await e(...t),{statusText:r}=n;if(!n.ok)throw new Error(r,{cause:n});const a=n.headers.get("content-type")||"";switch(!0){case a.includes(jt.json):return zo(n);case a.includes(jt.multipart):return Ko(n,a);default:throw new Error("".concat(on," ").concat(a),{cause:n})}}catch(n){return{[Symbol.asyncIterator](){return H(this,null,function*(){const r=cn(n);yield{errors:y(y({message:B(tt(n))},P("networkStatusCode",r==null?void 0:r.status)),P("response",r)),hasNext:!1}})}}}}}const Yo="mutation cartCreate($input:CartInput!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartCreate(input:$input){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",Qo="mutation cartBuyerIdentityUpdate($cartId:ID!$buyerIdentity:CartBuyerIdentityInput!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartBuyerIdentityUpdate(cartId:$cartId buyerIdentity:$buyerIdentity){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",Jo="mutation cartSelectedDeliveryOptionsUpdate($cartId:ID!$selectedDeliveryOptions:[CartSelectedDeliveryOptionInput!]!$country:CountryCode=CA$language:LanguageCode=EN$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartSelectedDeliveryOptionsUpdate(cartId:$cartId selectedDeliveryOptions:$selectedDeliveryOptions){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",Xo="mutation applePaySessionCreate($validationUrl:URL){applePaySessionCreate(validationUrl:$validationUrl){...@defer{applePaySession{body}}}}",Zo="mutation PaypalBuyerDetailsFetch($token:String!){paypalBuyerDetailsFetch(token:$token){...@defer{paypalDetails{email expiresAt destinationAddress{...on MailingAddress{address1 address2 city company country firstName lastName phone province zip}}billingAddress{...on MailingAddress{address1 address2 city company country firstName lastName phone province zip}}}}}}",ta="mutation payPalTokenCreate($cartId:ID!){paypalTokenCreate(cartId:$cartId){...@defer{paypalToken{token}}}}",ea="query cartQuery($id:ID!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){cart(id:$id){...@defer(if:$withCarrierRates){...CartParts}}}",na="query subscriptionPolicyQuery($country:CountryCode$language:LanguageCode)@inContext(country:$country language:$language){shop{subscriptionPolicy(sanitized:true){body}}}",ra="mutation cartPaymentUpdate($cartId:ID!$input:CartPaymentInput!$country:CountryCode$language:LanguageCode$withCarrierRates:Boolean=false)@inContext(country:$country language:$language){result:cartPaymentUpdate(cartId:$cartId payment:$input){...@defer(if:$withCarrierRates){cart{...CartParts}errors:userErrors{...on CartUserError{message field code}}}}}",qe="fragment CartParts on Cart{id checkoutUrl buyerIdentity{deliveryAddressPreferences{...on MailingAddress{address1 address2 city province phone country firstName lastName zip}}}deliveryGroups(first:10 withCarrierRates:$withCarrierRates){edges{node{id groupType selectedDeliveryOption{code title description handle estimatedCost{amount currencyCode}}deliveryOptions{code title description estimatedCost{amount currencyCode}handle}}}}cost{subtotalAmount{amount currencyCode}totalAmount{amount currencyCode}totalTaxAmount{amount currencyCode}totalDutyAmount{amount currencyCode}}discountAllocations{discountedAmount{amount currencyCode}...on CartCodeDiscountAllocation{code}...on CartAutomaticDiscountAllocation{title}...on CartCustomDiscountAllocation{title}}discountCodes{code applicable}lines(first:10){edges{node{quantity cost{subtotalAmount{amount currencyCode}totalAmount{amount currencyCode}}discountAllocations{discountedAmount{amount currencyCode}...on CartCodeDiscountAllocation{code}...on CartAutomaticDiscountAllocation{title}...on CartCustomDiscountAllocation{title}}merchandise{...on ProductVariant{requiresShipping}}sellingPlanAllocation{priceAdjustments{price{amount currencyCode}}sellingPlan{billingPolicy{...on SellingPlanRecurringBillingPolicy{interval intervalCount}}priceAdjustments{orderCount}recurringDeliveries}}}}}}",oa="mutation cartSubmitForCompletion($cartId:ID!$attemptToken:String!$country:CountryCode$language:LanguageCode)@inContext(country:$country language:$language){cartSubmitForCompletion(cartId:$cartId attemptToken:$attemptToken){result{__typename ...on SubmitSuccess{redirectUrl}...on SubmitThrottled{pollAfterV2:pollAfter}...on SubmitFailed{errors{code message}}}errors:userErrors{...on CartUserError{code field message}}}}",aa="unstable";class st extends Error{constructor(t="No response"){super(t),this.name="NoResponseError"}}class Rt{constructor({accessToken:t,country:n,locale:r,apiVersion:a=aa,withCarrierRates:o=!1}){if(c(this,"client"),c(this,"country"),c(this,"locale"),c(this,"withCarrierRates"),!t)throw new Error("StorefrontApiClient constructed with no access token");if(!n)throw new Error("StorefrontApiClient constructed with no buyer country");if(!r)throw new Error("StorefrontApiClient constructed with no locale");this.country=n,this.locale=r,this.withCarrierRates=o;const i="/api/".concat(a,"/graphql.json");this.client=Uo({headers:{"Content-Type":"application/json",Accept:"application/json","X-Shopify-Storefront-Access-Token":t,"X-SDK-Variant":"portable-wallets"},url:i,retries:0,logger:s=>{if(s.type==="HTTP-Response"){const[u,d]=s.content.requestParams;f.leaveBreadcrumb("POST: ".concat(u),{statusCode:s.content.response.status,statusText:s.content.response.statusText,url:u,method:d==null?void 0:d.method,headers:d==null?void 0:d.headers,body:d==null?void 0:d.body},"request")}}})}async createCart(t){var n;return this.requestDeferredCart(Yo,{input:{lines:[{merchandiseId:t.merchandiseId,quantity:t.quantity,sellingPlanId:t.sellingPlanId,attributes:Object.entries((n=t.lineItemProperties)!=null?n:{}).map(([r,a])=>({key:r,value:a}))}],discountCodes:t.discountCodes}})}async updateCartBuyerIdentity(t){const{cartId:n,emailAddress:r,streetAddress:a}=t;return this.requestDeferredCart(Qo,{cartId:n,buyerIdentity:{email:r,countryCode:a==null?void 0:a.country,phone:a==null?void 0:a.phone,deliveryAddressPreferences:a?[{deliveryAddressValidationStrategy:t.validateAddress?"STRICT":"COUNTRY_CODE_ONLY",deliveryAddress:a}]:void 0}})}async updateSelectedDeliveryOptions(t,n,r){let a=n;const o=Date.now()+2e4;for(;Date.now()<o&&!(r!=null&&r.aborted);){const i=await this.requestDeferredCart(Jo,{cartId:t,selectedDeliveryOptions:a});if(!i.errors.some(u=>u.startsWith(g.PendingDeliveryGroups)))return i;const s=i.data.deliveryGroups.flatMap(u=>u.deliveryOptions.map(d=>({deliveryOptionHandle:d.handle,deliveryGroupId:u.id})));a=a.map(u=>{var d;return(d=s.find(l=>l.deliveryOptionHandle===u.deliveryOptionHandle))!=null?d:u})}throw new Error("Selected delivery options update operation timed out")}async applePaySessionCreate(t){var n,r,a;const o=await this.requestStream([Xo],{validationUrl:t.toString()});try{for(var i=x(o),s,u,d;s=!(u=await i.next()).done;s=!1){const l=u.value;l.errors&&this.onError(l.errors);const h=(a=(r=(n=l.data)==null?void 0:n.applePaySessionCreate)==null?void 0:r.applePaySession)==null?void 0:a.body;if(h)return h}}catch(l){d=[l]}finally{try{s&&(u=i.return)&&await u.call(i)}finally{if(d)throw d[0]}}throw new st("Apple Pay session create operation returned no response")}async payPalBuyerDetailsFetch(t){const n=await this.requestStream([Zo],{token:t});try{for(var r=x(n),a,o,i;a=!(o=await r.next()).done;a=!1){const s=o.value;if(!s.hasNext)return s.errors&&this.onError(s.errors),s.data.paypalBuyerDetailsFetch.paypalDetails}}catch(s){i=[s]}finally{try{a&&(o=r.return)&&await o.call(r)}finally{if(i)throw i[0]}}throw new st("PayPal buyer details fetch operation returned no response")}async payPalTokenCreate(t){var n,r,a;const o=await this.requestStream([ta],{cartId:t});try{for(var i=x(o),s,u,d;s=!(u=await i.next()).done;s=!1){const l=u.value;l.errors&&this.onError(l.errors);const h=(a=(r=(n=l.data)==null?void 0:n.paypalTokenCreate)==null?void 0:r.paypalToken)==null?void 0:a.token;if(h)return h}}catch(l){d=[l]}finally{try{s&&(u=i.return)&&await u.call(i)}finally{if(d)throw d[0]}}throw new st("PayPal token create operation returned no response")}async fetchCart(t){var n;const r=this.formatLanguage(this.locale),a=await this.requestStream([ea,qe],{id:t,country:this.country,language:r,withCarrierRates:this.withCarrierRates});try{for(var o=x(a),i,s,u;i=!(s=await o.next()).done;i=!1){const d=s.value;d.errors&&this.onError(d.errors);const l=(n=d.data)==null?void 0:n.cart;if(l&&!d.hasNext)return this.parseCartResponse(l)}}catch(d){u=[d]}finally{try{i&&(s=o.return)&&await s.call(o)}finally{if(u)throw u[0]}}throw new st("Cart fetch operation returned no response")}async updateCartPayment(t,n,r){var a,o;const i={cartId:t,input:n},{amount:s,currencyCode:u}=n.amount;let d;const l=Date.now()+1e4;for(;Date.now()<l&&!(r!=null&&r.aborted);){const h=await this.requestDeferredCart(ra,i);if(d||(d=h),h.errors.includes(g.InvalidPaymentAmount)){parseFloat((o=(a=h.data.totalTaxAmount)==null?void 0:a.amount)!=null?o:"0")===0&&await new Promise(b=>setTimeout(b,500)),i.input.amount={amount:h.data.totalAmount.amount,currencyCode:h.data.totalAmount.currencyCode};continue}return(h.data.totalAmount.amount===s||parseFloat(h.data.totalAmount.amount)<=parseFloat(s))&&h.data.totalAmount.currencyCode===u?h:d}throw new Error("Payment update operation timed out")}async submitForCompletion(t,n){var r,a;const o=this.formatLanguage(this.locale),i=await this.request([oa],{cartId:t,attemptToken:n,country:this.country,language:o,withCarrierRates:this.withCarrierRates});return{data:(a=(r=i.data)==null?void 0:r.cartSubmitForCompletion)==null?void 0:a.result,errors:this.parseCompletionErrors(i)}}async fetchSubscriptionPolicy(){var t,n;const{data:r}=await this.request([na],{country:this.country,language:this.formatLanguage(this.locale)});return(n=(t=r==null?void 0:r.shop)==null?void 0:t.subscriptionPolicy)==null?void 0:n.body}async request(t,n){return this.client.request(t.join(""),{variables:n})}async requestStream(t,n){return this.client.requestStream(t.join(""),{variables:n})}async requestDeferredCart(t,n){var r,a;const o=this.formatLanguage(this.locale),i=await this.requestStream([t,qe],A(y({},n),{country:this.country,language:o,withCarrierRates:this.withCarrierRates}));try{for(var s=x(i),u,d,l;u=!(d=await s.next()).done;u=!1){const h=d.value;h.errors&&this.onError(h.errors);const b=(a=(r=h.data)==null?void 0:r.result)==null?void 0:a.cart;if(b&&!h.hasNext)return{data:await this.fetchCart(b.id),errors:this.parseMutationErrors(h,"result")}}}catch(h){l=[h]}finally{try{u&&(d=s.return)&&await d.call(s)}finally{if(l)throw l[0]}}throw new st("Deferred cart operation returned no response")}onError(t){var n,r;if(!t)return;f.leaveBreadcrumb("GraphQL response error",t,"error");const a=(r=(n=t.graphQLErrors)==null?void 0:n.map(s=>s.message).join(", "))!=null?r:"",o="".concat(t.message).concat(a.length>0?" - ".concat(a):""),i=t!=null&&t.networkStatusCode?"with status ".concat(t.networkStatusCode," => ").concat(o):"=> ".concat(o);throw new Error("GraphQL mutation failed ".concat(i))}formatLanguage(t){return t.includes("-")?t.split("-")[0].toUpperCase():t.toUpperCase()}parseCartResponse(t){var n,r,a;const o=t.lines.edges.map(s=>{var u,d;const l=s.node;return{quantity:l.quantity,totalAmount:{amount:l.cost.totalAmount.amount,currencyCode:l.cost.totalAmount.currencyCode},subtotalAmount:{amount:(u=l.cost.subtotalAmount)==null?void 0:u.amount,currencyCode:(d=l.cost.subtotalAmount)==null?void 0:d.currencyCode},merchandise:{requiresShipping:l.merchandise.requiresShipping},discountAllocations:l.discountAllocations,sellingPlanAllocation:l.sellingPlanAllocation}}),i=t.deliveryGroups.edges.map(s=>s.node);return{id:t.id,totalAmount:t.cost.totalAmount,subtotalAmount:(n=t.cost.subtotalAmount)!=null?n:void 0,totalTaxAmount:(r=t.cost.totalTaxAmount)!=null?r:void 0,totalDutyAmount:(a=t.cost.totalDutyAmount)!=null?a:void 0,discountAllocations:t.discountAllocations,discountCodes:t.discountCodes,lineItems:o,deliveryGroups:i,checkoutUrl:t.checkoutUrl}}parseGraphQlErrors(t){var n,r;return(r=(n=t==null?void 0:t.graphQLErrors)==null?void 0:n.map(a=>a.message.replace(/\(Expected.*\)/,"").trim()))!=null?r:[]}parseMutationErrors(t,n){var r,a,o;const i=this.parseGraphQlErrors(t.errors),s=((o=(a=(r=t.data)==null?void 0:r[n])==null?void 0:a.errors)==null?void 0:o.map(d=>d.field&&d.field.length>0?"".concat(d.code,": ").concat(d.field.join(".")):d.code).filter(d=>d))||[],u=[...i,...s];return f.leaveBreadcrumb("GraphQL errors on mutation",u,"error"),u}parseCompletionErrors(t){var n,r,a,o;const i=this.parseGraphQlErrors(t.errors);let s=[];((a=(r=(n=t.data)==null?void 0:n.cartSubmitForCompletion)==null?void 0:r.result)==null?void 0:a.__typename)==="SubmitFailed"&&(s=(o=t.data.cartSubmitForCompletion.result.errors.map(d=>d.code))!=null?o:[]);const u=[...i,...s];return f.leaveBreadcrumb("GraphQL errors on completion",u,"error"),u}}async function ia({cartId:e,cartClient:t,instrumentName:n,selectedDeliveryOptions:r,abortSignal:a}){try{if(!e)throw new Error("[".concat(n,"] provided no cart ID when updating shipping method"));if(!t)throw new Error("[".concat(n,"] provided invalid cart client when updating shipping method"));return await t.updateSelectedDeliveryOptions(e,r,a)}catch(o){throw v.updateFailed(n,"updateSelectedDeliveryOptions"),o}}async function sa({cartId:e,token:t,cartClient:n,instrumentName:r}){try{if(!e)throw new Error("[".concat(r,"] provided no cart ID when submitting for completion"));if(!n)throw new Error("[".concat(r,"] provided invalid cart client when submitting for completion"));if(!t)throw new Error("[".concat(r,"] provided no token when submitting for completion"));return await n.submitForCompletion(e,t)}catch(a){throw v.updateFailed(r,"submitForCompletion"),a}}function la({selectedDeliveryOptionHandles:e,deliveryGroups:t,instrumentName:n}){return t.map(r=>{const a=r.deliveryOptions.filter(o=>e.includes(o.handle));if(!a.length)throw new Error("[".concat(n,"] could not find delivery option for group: ").concat(r.id));if(a.length>1)throw new Error("[".concat(n,"] found multiple delivery options with selectedDeliverOptionHandle in group: ").concat(r.id));return{deliveryGroupId:r.id,deliveryOptionHandle:a[0].handle}})}class ca{constructor({accessToken:t,buyerCountry:n,buyerCurrency:r,button:a,i18n:o,merchantName:i,dataSource:s,apiClient:u,walletParams:d}){c(this,"name",m.ApplePay),c(this,"accessToken"),c(this,"button"),c(this,"buyerCountry"),c(this,"cart"),c(this,"apiClient"),c(this,"dataSource"),c(this,"i18n"),c(this,"merchantName"),c(this,"session"),c(this,"paymentSheetActionGenerator"),c(this,"shippingRequired"),c(this,"cancelled"),c(this,"buyerCurrency"),c(this,"abortController",null),c(this,"begin",()=>{f.leaveBreadcrumb("ApplePay Session begin",{},"log"),this.abortController=typeof AbortController=="function"&&new AbortController||null,this.session.begin()}),c(this,"onvalidatemerchant",async l=>{try{const h=new URL(l.validationURL),b=this.getMerchantSession(h),{cart:p}=await X({element:this.button,instrumentName:m.ApplePay,dataSource:this.dataSource});this.cart=p;const C=await b;if(f.leaveBreadcrumb("ApplePay Session completeMerchantValidation",{session:C},"log"),this.sessionIsCancelled())return;this.session.completeMerchantValidation(C)}catch(h){this.terminateSession(h)}}),c(this,"onshippingcontactselected",async l=>{var h,b;try{const p=ft(l.shippingContact),C=await wt({cartId:this.cart.id,streetAddress:p,cartClient:this.apiClient,instrumentName:this.name}),w=(h=C.data)!=null?h:this.cart;if(this.currencyChanged(w)){w&&this.decelerateForCurrencyChange(w),this.terminateSession();return}const E=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(C,{shippingRequired:this.shippingRequired});if((b=E.effects)==null||b.forEach(W=>W()),this.sessionIsCancelled())return;it({paymentSheetAction:E,onProceed:W=>this.completeShippingContactSelection(C.data,W),terminateSession:this.terminateSession})}catch(p){this.terminateSession(p)}}),c(this,"onshippingmethodselected",async l=>{var h,b;try{const p=l.shippingMethod.identifier.split(","),C=la({selectedDeliveryOptionHandles:p,deliveryGroups:this.cart.deliveryGroups,instrumentName:m.ApplePay}),w=await ia({cartId:this.cart.id,cartClient:this.apiClient,instrumentName:this.name,selectedDeliveryOptions:C,abortSignal:(h=this.abortController)==null?void 0:h.signal}),E=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(w);if((b=E.effects)==null||b.forEach(W=>W()),this.sessionIsCancelled())return;it({paymentSheetAction:E,onProceed:()=>this.completeShippingMethodSelection(w.data),terminateSession:this.terminateSession})}catch(p){this.terminateSession(p)}}),c(this,"onpaymentmethodselected",async l=>{var h,b;try{const{billingContact:p}=l.paymentMethod;if(!this.shippingRequired&&p){const E=ft(p),W=await wt({cartId:this.cart.id,streetAddress:E,cartClient:this.apiClient,instrumentName:this.name}),pe=(h=W.data)!=null?h:this.cart;if(this.currencyChanged(pe)){pe&&this.decelerateForCurrencyChange(pe),this.terminateSession();return}const ye=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(W);(b=ye.effects)==null||b.forEach(z=>z()),await it({paymentSheetAction:ye,onProceed:()=>this.cart=W.data,terminateSession:this.terminateSession})}const{newTotal:C,newLineItems:w}=this.getNewTotalAndLineItems(this.cart);if(f.leaveBreadcrumb("ApplePay Session completePaymentMethodSelection",{newTotal:C,newLineItems:w},"log"),this.sessionIsCancelled())return;this.session.completePaymentMethodSelection({newTotal:C,newLineItems:w})}catch(p){this.terminateSession(p)}}),c(this,"oncancel",()=>{var l;this.cancelled=!0,v.sheetCancelled(m.ApplePay),this.button.disabled=!1,(l=this.abortController)==null||l.abort()}),c(this,"onpaymentauthorized",async l=>{const h=async z=>{var de,me;switch((de=z.effects)==null||de.forEach(ue=>ue()),z.action){case"complete":{const ue=ApplePaySession.STATUS_SUCCESS;try{await this.completePayment(ue),v.sheetSuccess(m.ApplePay),window.location.assign(z.redirectUrl)}catch(he){this.terminateSession(he)}break}case"show_error":{const ue=(me=z.errors)!=null?me:[];try{await this.completePayment(ApplePaySession.STATUS_FAILURE,ue)}catch(he){this.terminateSession(he)}break}case"abort":{try{await this.completePayment(ApplePaySession.STATUS_FAILURE),this.button.disabled=!1}catch(ue){this.terminateSession(ue)}break}default:this.terminateSession(new Error("[".concat(m.ApplePay,"] completion action not handled: ").concat(z.action)))}},{token:b,billingContact:p,shippingContact:C}=l.payment;let w=null,E=null;try{if(!p){await this.completePayment(ApplePaySession.STATUS_FAILURE);return}if(w=ft(A(y({},p),{phoneNumber:C==null?void 0:C.phoneNumber})),this.shippingRequired){if(!C){await this.completePayment(ApplePaySession.STATUS_FAILURE);return}E=ft(C)}}catch(z){this.terminateSession(z);return}const W=async()=>{try{const z=this.shippingRequired?{validateAddress:!0,streetAddress:E}:{},de=await wt(y({cartId:this.cart.id,emailAddress:C.emailAddress,cartClient:this.apiClient,instrumentName:this.name},z)),me=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(de);await it({paymentSheetAction:me,onProceed:async ue=>{ue&&ue.length>0?await this.completePayment(ApplePaySession.STATUS_FAILURE,ue):await pe()},terminateSession:this.terminateSession})}catch(z){this.terminateSession(z)}},pe=async()=>{var z;try{const de=this.cart.lineItems.some(he=>!!he.sellingPlanAllocation),me=await en({cartId:this.cart.id,totalAmount:this.cart.totalAmount,paymentMethod:{walletPaymentMethod:{applePayWalletContent:{billingAddress:w,data:b.paymentData.data,header:b.paymentData.header,lastDigits:b.paymentMethod.displayName.split(" ")[1],signature:b.paymentData.signature,version:b.paymentData.version}}},billingAddress:w,cartClient:this.apiClient,instrumentName:this.name,hasSellingPlan:de,abortSignal:(z=this.abortController)==null?void 0:z.signal}),ue=this.paymentSheetActionGenerator.mapMutationResultToPaymentSheetAction(me);await it({paymentSheetAction:ue,onProceed:async he=>{he&&he.length>0?await this.completePayment(ApplePaySession.STATUS_FAILURE,he):await ye()},terminateSession:this.terminateSession})}catch(de){this.terminateSession(de)}},ye=async()=>{try{const z=await sa({cartId:this.cart.id,token:b.transactionIdentifier,cartClient:this.apiClient,instrumentName:this.name}),de=this.paymentSheetActionGenerator.mapCompletionResultToPaymentSheetAction(z);await h(de)}catch(z){this.terminateSession(z)}};await W()}),c(this,"terminateSession",l=>{var h;this.button.disabled=!1,l&&f.notify(l);try{f.leaveBreadcrumb("ApplePay Session abort",{},"log"),this.session.abort(),(h=this.abortController)==null||h.abort()}catch(b){f.notify(b)}if(l){const b=this.i18n.translate("brand.apple_pay");pt(this.i18n.translate("error_dialogs.wallet.title",{wallet:b}),this.i18n.translate("error_dialogs.wallet.generic_error",{wallet:b}))}}),c(this,"getMostRecentNonNullCart",(l,h)=>l?(this.cart=l,l):h),c(this,"handleNullCart",l=>{if(!l)throw new Error("[".concat(m.ApplePay,"] no cart returned on mutation, aborting"))}),c(this,"completeShippingContactSelection",(l,h)=>{try{const b=this.getMostRecentNonNullCart(l,this.cart),{newTotal:p,newLineItems:C}=this.getNewTotalAndLineItems(b),w=Eo(b.deliveryGroups,this.i18n);f.leaveBreadcrumb("ApplePay Session completeShippingContactSelection",{errors:h,newTotal:p,newLineItems:C,newShippingMethods:w},"log"),this.session.completeShippingContactSelection({errors:h!=null?h:[],newTotal:p,newLineItems:C,newShippingMethods:w})}catch(b){this.terminateSession(b)}}),c(this,"completeShippingMethodSelection",l=>{try{this.handleNullCart(l),this.cart=l;const{newTotal:h,newLineItems:b}=this.getNewTotalAndLineItems(l);f.leaveBreadcrumb("ApplePay Session completeShippingContactSelection",{newTotal:h,newLineItems:b},"log"),this.session.completeShippingMethodSelection({newTotal:h,newLineItems:b})}catch(h){this.terminateSession(h)}}),c(this,"sessionIsCancelled",()=>this.cancelled),this.shippingRequired=s.shippingRequired(),this.session=new ApplePaySession(je,Io({shippingRequired:this.shippingRequired,walletParams:d,buyerCurrency:r})),this.accessToken=t,this.buyerCountry=n,this.button=a,this.cart=null,this.apiClient=u,this.dataSource=s,this.i18n=o,this.merchantName=i,this.cancelled=!1,this.buyerCurrency=r,this.session.onvalidatemerchant=this.onvalidatemerchant,this.session.onshippingcontactselected=this.onshippingcontactselected,this.session.onshippingmethodselected=this.onshippingmethodselected,this.session.onpaymentmethodselected=this.onpaymentmethodselected,this.session.oncancel=this.oncancel,this.session.onpaymentauthorized=this.onpaymentauthorized,this.paymentSheetActionGenerator=new _o(o)}async getMerchantSession(t){const n=await new Rt({accessToken:this.accessToken,country:this.buyerCountry,locale:this.i18n.locale,apiVersion:"unstable"}).applePaySessionCreate(t);return JSON.parse(n)}async completePayment(t,n=void 0){f.leaveBreadcrumb("ApplePay Session completePayment",{status:t,errors:n},"log"),this.session.completePayment({status:t,errors:n})}getNewTotalAndLineItems(t){return{newTotal:yo(this.merchantName,t.totalAmount),newLineItems:fo({subtotal:To(t),discountAllocations:ko(t),deliveryGroups:t.deliveryGroups,duties:t.totalDutyAmount,taxes:t.totalTaxAmount,i18n:this.i18n,formattedRecurringTotals:No(this.cart.lineItems,this.i18n)})}}currencyChanged(t){return t?this.buyerCurrency.toUpperCase()!==t.totalAmount.currencyCode.toUpperCase():!1}decelerateForCurrencyChange(t){const n=new URL(t.checkoutUrl);n.searchParams.set(Jn.CURRENCY_CHANGE,"true"),v.decelerated({instrument:m.ApplePay,reason:"currency_changed"}),k.exportMetrics(),window.location.assign(n)}}const ua='<svg viewBox="0 0 43 19" xmlns="http://www.w3.org/2000/svg" width="45px" style="width: 45px;">\n  <path d="M6.948 1.409C7.934.147 9.305.147 9.305.147s.193 1.18-.771 2.316c-1.05 1.2-2.228.993-2.228.993s-.236-.93.642-2.047zM3.82 3.663c-1.735 0-3.6 1.51-3.6 4.363 0 2.916 2.186 6.555 3.943 6.555.6 0 1.543-.6 2.485-.6.922 0 1.607.559 2.464.559 1.907 0 3.322-3.826 3.322-3.826s-2.015-.744-2.015-2.936c0-1.944 1.629-2.73 1.629-2.73s-.836-1.447-2.936-1.447c-1.22 0-2.164.661-2.656.661-.622.021-1.5-.6-2.636-.6zM19.64 1.426c2.453 0 4.188 1.788 4.188 4.396 0 2.608-1.755 4.417-4.248 4.417h-2.932v4.564h-1.974V1.426h4.966zm-2.992 7.067h2.473c1.695 0 2.693-.967 2.693-2.65 0-1.683-.978-2.671-2.693-2.671h-2.473v5.321zm7.559 3.429c0-1.767 1.296-2.777 3.65-2.945l2.572-.147v-.78c0-1.156-.738-1.787-1.994-1.787-1.037 0-1.795.568-1.955 1.43h-1.775c.06-1.788 1.656-3.092 3.79-3.092 2.333 0 3.829 1.304 3.829 3.281v6.9h-1.815v-1.684h-.04c-.519 1.094-1.715 1.788-3.012 1.788-1.934.021-3.25-1.178-3.25-2.965zm6.222-.905v-.778l-2.313.168c-1.297.084-1.975.59-1.975 1.494 0 .862.718 1.409 1.815 1.409 1.396-.021 2.473-.968 2.473-2.293zm3.969 7.383v-1.64c.14.041.438.041.598.041.897 0 1.416-.4 1.735-1.472l.14-.526L33.4 4.707h2.054l2.453 8.224h.04L40.4 4.707h1.994l-3.57 10.538c-.818 2.419-1.715 3.197-3.67 3.197-.14.02-.598-.021-.757-.042z"/>\n</svg>\n',Ut="{{ICON}}";class da extends V{constructor(){super(),c(this,"fragment",null),c(this,"button",null),c(this,"logoElement"),this.logoElement=new DOMParser().parseFromString(ua,"image/svg+xml").documentElement}static get observedAttributes(){return["disabled"]}get merchantName(){return this.walletParams.merchantName}async connectedCallback(){this.render()}attributeChangedCallback(t,n,r){super.attributeChangedCallback(t,n,r,this.button)}async handleClick(t){if(t.preventDefault(),this.disabled||!this.button||this.button.hasAttribute("aria-disabled"))return;this.disabled=!0;const[n,r,a]=await Promise.all([this.i18n,this.dataSource,this.apiClient]);let o;try{if(o=new ca({accessToken:this.accessToken,buyerCountry:this.buyerCountry,buyerCurrency:this.buyerCurrency,button:this,i18n:n,merchantName:this.merchantName,dataSource:r,apiClient:a,walletParams:this.walletParams}),!o)throw new Error("missing ApplePaySession");o.begin(),v.sheetClicked({instrument:m.ApplePay,result:"success"})}catch(i){f.notify(i),v.sheetClicked({instrument:m.ApplePay,result:"failed"}),o==null||o.terminateSession()}}async render(){var t;if(!this.button){const n=await this.classNames;this.button=Nt(),this.button.onclick=a=>this.handleClick(a),this.button.className="apple-pay-button ".concat(Gn[this.buttonTheme]," ").concat(n);const r=this.hasAttribute("call-to-action");await this.addBranding(this.button,r)}if(this.disabled&&this.button.setAttribute("aria-disabled","true"),!this.fragment){this.fragment=document.createDocumentFragment();const n=document.createElement("style");n.innerHTML=po,this.fragment.append(n,this.button),this.appendChild(this.fragment),(t=this.onRendered)==null||t.call(this)}}async addBranding(t,n){const r=await this.i18n,a=r.translate("buy_with_button_content"),o=r.translate("brand.apple_pay");t.setAttribute("aria-label",n?a.replace(Ut,o):o),t.appendChild(this.htmlContent(n?a:null))}htmlContent(t){if(!t)return this.logoElement;const n=document.createElement("div");return n.classList.add("apple-pay--content"),t.split(new RegExp("(".concat(Ut,")"))).filter(Boolean).map(r=>{let a;r===Ut?a=this.logoElement:(a=document.createElement("span"),a.innerText=r,a.setAttribute("aria-hidden","true")),n.appendChild(a)}),n}}function ie(e){return function(t,n,r){const a=r.value;return r.value=function(...o){const i=a.apply(this,o);return i.eligible||console.debug("[DEBUG] ".concat(e," could not be rendered. Reason: ").concat(i.reason)),i},r}}var ha=Object.defineProperty,pa=Object.getOwnPropertyDescriptor,fn=(e,t,n,r)=>{for(var a=r>1?void 0:r?pa(t,n):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(r?i(t,n,a):i(a))||a);return r&&a&&ha(t,n,a),a};class se extends Z{constructor(t){super(t),c(this,"companyFieldRequired"),this.companyFieldRequired=!!this.walletParams.companyRequired}static walletName(){return"apple_pay"}getWebComponentName(){return"shopify-apple-pay-button"}getWebComponentClass(){return da}getInstrumentName(){return m.ApplePay}applePayInIframe(){return typeof window>"u"||window.self!==window.top}getLoadEligibility(){return this.applePayInIframe()?{eligible:!1,reason:"cannot be loaded in an iframe"}:{eligible:!0}}getPartnerSDKEligibility(){var t,n,r,a;return typeof window>"u"||window.ApplePaySession===void 0?{eligible:!1,reason:"window or ApplePaySession is undefined"}:(n=(t=window.ApplePaySession).supportsVersion)!=null&&n.call(t,je)?(a=(r=window.ApplePaySession).canMakePayments)!=null&&a.call(r)?{eligible:!0}:{eligible:!1,reason:"failed SDK eligibility check"}:{eligible:!1,reason:"SDK does not meet minimum version requirement"}}}fn([ie("Apple Pay")],se.prototype,"getLoadEligibility",1),fn([ie("Apple Pay")],se.prototype,"getPartnerSDKEligibility",1);const ma=".buy-with-prime-button:hover:enabled{background-color:#0684eb!important}.buy-with-prime-button:focus{box-shadow:0 0 0 2px #1a98ff,inset 0 0 0 2px rgb(var(--color-background))!important;outline:none!important}.buy-with-prime-button:active,.buy-with-prime-button:hover:enabled:active{background-color:#0066cd!important;box-shadow:none!important}";class vt extends Error{constructor(){super(...arguments),c(this,"name","MissingAccessTokenError")}}class le extends Error{constructor(){super(...arguments),c(this,"name","FetchingWalletsPlatformConfigError")}}class gn extends Error{constructor(){super(...arguments),c(this,"name","EmptyLineItemsWalletsPlatformConfigError")}}async function bn({configOptionsEndpoint:e,checkoutUrl:t,sourceId:n,accessToken:r,instrument:a}){try{const o=JSON.stringify({checkout_url:t,checkout_cancel_url:window.location.href,cart_id:n}),i=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":r},body:o});if(i.ok)return i.json();const s=await i.json();throw s.error?new Error(s.error):new Error("Could not fetch wallets platform configs: [".concat(i.status,"] ").concat(i.statusText))}catch(o){const{message:i}=o!=null?o:{};switch(i){case"empty_line_items":throw new gn("[Fetch Pay Config][".concat(a,"] No eligible line items provided in the config request."));default:throw new le("[Fetch Pay Config][".concat(a,"] ").concat(i))}}}const G=class fe extends V{constructor(){super(...arguments),c(this,"fragment",null),c(this,"button",null)}async connectedCallback(){this.render()}disconnectedCallback(){}createButton(){const t=Nt();return t.type="button",t.role="button",t.className="buy-with-prime-button",Mt(t,{width:"100%","padding-top":"12px","padding-bottom":"8px","padding-right":"10px","padding-left":"10px",display:"flex","align-items":"center","justify-content":"center",gap:"5px",opacity:"1","border-width":"0px"}),this.applyEnabledStyles(t),t}applyEnabledStyles(t){t.innerHTML=dt.primeLogo,t.disabled=!1,Mt(t,{"background-color":"#1A98FF",color:"#FFFFFF",cursor:"pointer"})}applyDisabledStyles(t){t.innerHTML=dt.primeLogoDark,t.disabled=!0,Mt(t,{"background-color":"#C0E3FF",color:"#7292AC",cursor:"not-allowed"})}async handleClick(){var t;if(!this.button)return;const[n,r]=await Promise.all([this.i18n,this.dataSource]);try{this.applyDisabledStyles(this.button);let a=this.walletParams;if(!a.createCheckoutSessionConfig){const{cart:o}=await X({element:this,instrumentName:m.BuyWithPrime,dataSource:r,sendTelemetryOnError:!1});if(!this.accessToken)throw new vt("[Fetch Pay Config] could not fetch pay configs since required accessToken is missing.");a=A(y({},await bn({configOptionsEndpoint:fe.OPTIMUS_CONFIG_REST_API_URL,checkoutUrl:o.checkoutUrl,sourceId:(t=te(o))!=null?t:"",accessToken:this.accessToken,instrument:m.BuyWithPrime})),{placement:this.pageType===_.ProductPage?"Product":"Cart"})}window.amazon.buywithprime.initCheckout({amazonPayOptions:a}),v.sheetClicked({instrument:m.BuyWithPrime,result:"success"})}catch(a){const{name:o}=a!=null?a:{};fe.EXPECTED_ERRORS.includes(o)||f.notify(a),v.sheetClicked({instrument:m.BuyWithPrime,result:"failed"});const{title:i,content:s}=this.getErrorCopies(o,n);pt(i,s)}finally{this.applyEnabledStyles(this.button)}}getErrorCopies(t,n){switch(t){case"EmptyLineItemsWalletsPlatformConfigError":return{title:n.translate("error_dialogs.wallet.buy_with_prime.empty_line_items.title"),content:n.translate("error_dialogs.wallet.buy_with_prime.empty_line_items.content")};default:return{title:n.translate("error_dialogs.checkout.title"),content:n.translate("error_dialogs.checkout.generic_error")}}}async render(){var t;if(!this.button){const n=await this.classNames;this.button=this.createButton(),this.button.onclick=()=>this.handleClick(),this.button.className="buy-with-prime-button ".concat(n)}if(!this.fragment){this.fragment=document.createDocumentFragment();const n=document.createElement("style");n.innerHTML=ma,this.fragment.append(n,this.button),this.appendChild(this.fragment)}(t=this.onRendered)==null||t.call(this)}};c(G,"OPTIMUS_CONFIG_REST_API_URL","".concat(window.location.origin,"/wallets/config/optimus")),c(G,"EXPECTED_ERRORS",[le.name,vt.name,gn.name]);let Ht=G;async function Ft(e){const t=e.createCheckoutSessionConfig,n=JSON.parse(t.payloadJSON),r=new URL(n.webCheckoutDetails.checkoutReviewReturnUrl);await fetch("https:///sandbox/v2/checkoutSessions",{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"}}),r.searchParams.set("amazonCheckoutSessionId","testCheckoutSessionId"),r.searchParams.set("promiseId","testPromiseId"),window.location.href=r.toString()}const wn={buywithprime:{initCheckout:async e=>{Ft(e.amazonPayOptions)}},Pay:{initCheckout:async e=>{Ft(e)},renderButton:()=>({initCheckout:Ft,onClick:()=>{}})}};async function ya(){return window.amazon=wn,"loaded"}async function fa(e){return new Promise((t,n)=>{if(document.querySelector('script[src="'.concat(e,'"]'))&&window.amazon){t();return}const r=document.createElement("script");r.src=e,r.onload=()=>{window.amazon?t():n(new Error("Amazon SDK not present after loading"))},r.onerror=()=>{n(new Error("Error loading Amazon SDK"))},document.head.append(r)})}async function Cn({sdkUrl:e=Xt,maxRetries:t=3,shouldMock:n=!1}){let r=0;if(n){await ya();return}do try{await fa(e);break}catch(a){if(r++,r===t)throw a}while(r<t)}const D=class ge extends Z{static walletName(){return"buy_with_prime"}constructor(t){super(t)}getWebComponentName(){return"shopify-buy-with-prime-button"}getInstrumentName(){return m.BuyWithPrime}isMockedAmazonServiceUsed(){return!1}getWebComponentClass(){return Ht}async loadWalletSDK(){await Cn({sdkUrl:ge.SDK_URL,shouldMock:this.isMockedAmazonServiceUsed(),maxRetries:ge.MAX_RETRIES}),await this.loadLogos()}async loadLogos(){await Promise.all([this.loadPrimeLogo(),this.loadPrimeLogoDark()])}async loadPrimeLogo(){ge.primeLogo=(await import("./prime-logo-BZwEw4MO.js")).default}async loadPrimeLogoDark(){ge.primeLogoDark=(await import("./prime-logo-dark-BcbvIWWI.js")).default}};c(D,"MAX_RETRIES",3),c(D,"SDK_URL",Xt),c(D,"primeLogo"),c(D,"primeLogoDark");let dt=D;const $=class be extends V{constructor(){super(...arguments),c(this,"container",null)}async connectedCallback(){await this.render()}async handleClick(t){var n;try{const r=await this.dataSource,{cart:a}=await X({element:this,instrumentName:m.AmazonPay,dataSource:r,sendTelemetryOnError:!1}),{totalAmount:{amount:o},checkoutUrl:i}=a;let s=this.walletParams;if(!s.createCheckoutSessionConfig){if(!this.accessToken)throw new vt("[Fetch Pay Config] could not fetch pay configs since required accessToken is missing.");s=A(y({},await bn({configOptionsEndpoint:be.CV2_CONFIG_REST_API_URL,checkoutUrl:i,sourceId:(n=te(a))!=null?n:"",accessToken:this.accessToken,instrument:m.AmazonPay})),{placement:this.pageType===_.ProductPage?"Product":"Cart"})}t.initCheckout(y(y({},s),Number(o)!==0&&{estimatedOrderAmount:{amount:o,currencyCode:this.buyerCurrency}})),v.sheetClicked({instrument:m.AmazonPay,result:"success"})}catch(r){const{name:a}=r!=null?r:{};be.EXPECTED_ERRORS.includes(a)||f.notify(r),v.sheetClicked({instrument:m.AmazonPay,result:"failed"})}}createContainer(){const t=document.createElement("div");return t.id=be.CONTAINER_ID,t.style.display="flex",t}async render(){var t;if(!this.container){this.container=this.createContainer(),this.appendChild(this.container);const n=window.amazon.Pay.renderButton("#".concat(be.CONTAINER_ID),A(y({},this.walletParams),{placement:this.pageType===_.ProductPage?"Product":"Cart"}));n==null||n.onClick(()=>this.handleClick(n)),(t=this.onRendered)==null||t.call(this)}}};c($,"CV2_CONFIG_REST_API_URL","".concat(window.location.origin,"/wallets/config/amazon_pay")),c($,"CONTAINER_ID","PortableWalletsAmazonPayButtonContainer"),c($,"EXPECTED_ERRORS",[le.name,vt.name]);let Kt=$;const Y=class we extends Z{static walletName(){return"amazon_pay"}constructor(t){super(t)}getWebComponentName(){return"shopify-amazon-pay-button"}getInstrumentName(){return m.AmazonPay}isMockedAmazonServiceUsed(){return!1}getWebComponentClass(){return Kt}async loadWalletSDK(){if(await Cn({sdkUrl:we.SDK_URL,shouldMock:!1,maxRetries:we.MAX_RETRIES}),this.isMockedAmazonServiceUsed()){const t=window.amazon.Pay.renderButton;window.amazon.Pay.renderButton=(n,r)=>{const a=t(n,r);return a.initCheckout=wn.Pay.initCheckout,a}}}};c(Y,"MAX_RETRIES",3),c(Y,"SDK_URL",Xt);let Gt=Y;class ga extends V{constructor(){super(...arguments),c(this,"button",null)}static get observedAttributes(){return["disabled"]}async connectedCallback(){this.render()}disconnectedCallback(){this.button&&this.removeChild(this.button)}async render(){this.button||(this.button=document.createElement("button"),this.button.type="button");const t=await this.classNames;this.disabled&&this.button.setAttribute("aria-disabled","true"),this.button.textContent="Buy with Shop Pay",this.button.className=t,this.appendChild(this.button)}}var ba=Object.defineProperty,wa=Object.getOwnPropertyDescriptor,Ca=(e,t,n,r)=>{for(var a=r>1?void 0:r?wa(t,n):t,o=e.length-1,i;o>=0;o--)(i=e[o])&&(a=(r?i(t,n,a):i(a))||a);return r&&a&&ba(t,n,a),a};class vn extends Z{static walletName(){return"shop_pay"}constructor(t){super(t)}getWebComponentName(){return"shop-pay-button"}getWebComponentClass(){return ga}getInstrumentName(){return m.ShopPay}getLoadEligibility(){return{eligible:!0}}}Ca([ie("Shop Pay")],vn.prototype,"getLoadEligibility",1);const va=[co,ho,se,dt,Gt,vn],Sa=new Map(va.map(e=>[e.walletName(),t=>new e(t)]));function Sn(e){const t=Sa.get(e.name);return t?t(e):(console.debug("Can't build wallet with name ".concat(e.name)),null)}function En(e){return e.map(t=>Sn(t)).filter(Boolean)}var mt=(e=>(e.ButtonDisplay="buttonDisplay",e.LoadInstrument="loadInstrument",e))(mt||{});function An(){var e,t;return!!((e=window.performance)!=null&&e.mark)&&!!((t=window.performance)!=null&&t.measure)}function xt(e,t){return Ea(e,t),()=>Aa(e,t)}function Ea(e,t){An()&&window.performance.mark("".concat(e,"-").concat(t,"-start"))}function Aa(e,t){var n,r;if(An())try{const a="".concat(e,"-").concat(t,"-start"),o="".concat(e,"-").concat(t,"-end"),i="".concat(e,"-").concat(t,"-duration");window.performance.mark(o);const s=(r=window.performance.measure(i,a,o))!=null?r:(n=window.performance.getEntriesByName(i,"measure"))==null?void 0:n[0],u=s==null?void 0:s.duration;if(u==null){f.notify(new Error("Could not measure performance of ".concat(e," ").concat(t)),{severity:"warning"});return}return u}catch(a){f.notify(a);return}}const Pn="dynamic-checkout .wallet-button-fade-in,cart-wallet-buttons .wallet-button-fade-in{animation:animation-fade-in .3s cubic-bezier(.1,.79,1,1)}dynamic-checkout .shopify-payment-button__button,cart-wallet-buttons .shopify-payment-button__button{cursor:pointer}@keyframes animation-fade-in{0%{opacity:0}to{opacity:1}}button[aria-disabled=true]{opacity:.5;cursor:not-allowed}",Pa=".shopify-payment-button__button--hidden{visibility:hidden}.shopify-payment-button__button{border-radius:4px;border:none;box-shadow:0 0 0 0 transparent;color:#fff;cursor:pointer;display:block;font-size:1em;font-weight:500;line-height:1;text-align:center;width:100%;height:44px;transition:background .2s ease-in-out}.shopify-payment-button__button[disabled]{opacity:.6;cursor:default}.shopify-payment-button__button--unbranded{background-color:#1990c6;padding:1em 2em}.shopify-payment-button__button--unbranded:hover:not([disabled]){background-color:#136f99}.shopify-payment-button__more-options{background:transparent;border:0 none;cursor:pointer;display:block;font-size:1em;margin-top:1em;text-align:center;text-decoration:underline;width:100%}.shopify-payment-button__more-options.shopify-payment-button__skeleton{width:50%;margin-left:25%;margin-right:25%}.shopify-payment-button__more-options[disabled]{opacity:.6;cursor:default}.shopify-payment-button__button--branded{display:flex;flex-direction:column;position:relative;z-index:1}.shopify-payment-button__button--branded .shopify-cleanslate{flex:1!important;display:flex!important;flex-direction:column!important}.shopify-payment-button__button.button.loading{position:relative;color:transparent}.shopify-payment-button__button.button.loading>.loading-overlay__spinner{top:50%;left:50%;transform:translate(-50%,-50%);position:absolute;height:100%;display:flex;align-items:center}.shopify-payment-button__button.button.loading>.loading-overlay__spinner .spinner{width:-moz-fit-content;width:-webkit-fit-content;width:fit-content}.button.loading>.loading-overlay__spinner .path{stroke:#fff}.shopify-payment-button__button .loading-overlay__spinner{width:1.8rem;display:inline-block}.shopify-payment-button__button .spinner{animation:shopify-rotator 1.4s linear infinite}@keyframes shopify-rotator{0%{transform:rotate(0)}to{transform:rotate(270deg)}}.shopify-payment-button__button .path{stroke-dasharray:280;stroke-dashoffset:0;transform-origin:center;stroke:#121212;animation:shopify-dash 1.4s ease-in-out infinite}@media screen and (forced-colors: active){.shopify-payment-button__button .path{stroke:CanvasText}}@keyframes shopify-dash{0%{stroke-dashoffset:280}50%{stroke-dashoffset:75;transform:rotate(135deg)}to{stroke-dashoffset:280;transform:rotate(450deg)}}@keyframes walletsLoadingSkeleton{50%{opacity:1}75%{opacity:.5}to{opacity:1}}.shopify-payment-button__skeleton{animation:walletsLoadingSkeleton 4s ease infinite;animation-delay:-.168s;background-color:#dedede;box-sizing:border-box;text-decoration:none!important}";function _n(e,t,n){if(ct!=null&&ct.length){const r=ct.join(",");e.querySelectorAll(r).forEach(a=>{n===null?a.removeAttribute(t):a.setAttribute(t,n)})}}function In(e,t){try{const n=JSON.parse(e!=null?e:"[]");if(!(n instanceof Array))throw new Error("[".concat(t,"] invalid walletConfigs found"));return n}catch(n){throw new Error("[".concat(t,"] Error while parsing walletConfigs JSON: ").concat(n))}}function _a(e,t){try{return e?JSON.parse(e):null}catch(n){throw new Error("[".concat(t,"] Error while parsing walletConfig JSON: ").concat(n))}}function Tn(e){return e.filter(t=>t.getLoadEligibility().eligible)}class Ia{constructor(t,n,r,a){this.getElement=t,this.apiClient=n,this.instrumentName=r,this.variantParams=a}async getCart(){const t=this.getElement(),n=Ne(t);if(!n)throw new Error("[".concat(this.instrumentName,"] unable to find product form"));const r=Ct(Qn),{data:a,errors:o}=await this.apiClient.createCart(A(y({},n),{discountCodes:r?[decodeURIComponent(r)]:[]}));if(!a)throw new Error("Failed to create cart: No cart returned");return{cart:a,errors:o}}shippingRequired(){var t;const n=this.getElement(),r=Ne(n);return!!((t=this.variantParams.find(a=>a.id===Number(r==null?void 0:r.variantId)))!=null&&t.requiresShipping)}}function kn({instanceNumber:e,styleId:t,styles:n,cssFileName:r}){var a,o;e===1&&(o=(a=window.Shopify)==null?void 0:a.PaymentButton)!=null&&o.isStorefrontPortableWallets&&(Ta({styleId:t,styles:n,cssFileName:r})||ka({styleId:t,styles:n}))}function Ta({styleId:e,styles:t,cssFileName:n}){return!!document.querySelector("style#".concat(e))}function ka({styleId:e,styles:t}){const n=document.createElement("style");n.id=e,n.innerHTML=t,document.head.appendChild(n)}const _t=class Ma extends oe{constructor(){super(),c(this,"instanceNumber",++Ma.instanceCount),c(this,"formObserver"),c(this,"wrapper",document.createElement("div")),c(this,"i18n"),c(this,"dataSource"),c(this,"apiClient"),this.formObserver=new io(this,t=>this.disabled=t,t=>this.hasSellingPlan=t),Zt({shop:{shopId:this.shopId}}),kn({instanceNumber:this.instanceNumber,styleId:"shopify-dynamic-checkout",styles:Pa,cssFileName:"dynamic-checkout-base.css"})}static get observedAttributes(){return["access-token","disabled","has-selling-plan"]}async connectedCallback(){var t,n;try{if((n=(t=this.wrapper)==null?void 0:t.children)!=null&&n.length)return;if(!this.validateRenderingSurface()){this.clearUI();return}this.instanceNumber===1&&v.initStarted();const r=xt(mt.ButtonDisplay,"dc:".concat(this.instanceNumber));this.i18n=kt();const a=()=>this.wrapper,o=await this.loadWallet(),i=o.getInstrumentName()===m.ApplePay;this.apiClient=new Rt({accessToken:this.accessToken,country:this.buyerCountry,locale:this.i18n.locale,withCarrierRates:i}),this.dataSource=new Ia(a,this.apiClient,o.getInstrumentName(),this.variantParams);const s=o.createWebComponent({accessToken:this.accessToken,country:this.buyerCountry,currency:this.buyerCurrency,disabled:String(this.disabled),dataSource:this.dataSource,i18n:this.i18n,apiClient:this.apiClient,classNames:Da(o.getInstrumentName()),callToAction:"true",pageType:_.ProductPage});if(!s)throw new Error("[DynamicCheckout] No web component found");const u=o.getInstrumentName();s.onRendered=()=>{v.instrumentLoaded({instrument:u,measurement:r()})},this.render(s,u),this.formObserver.setupMutationObservers(),v.initCompleted({result:"success"}),this.instanceNumber===1&&this.triggerLoadedEvent()}catch(r){if(this.clearUI(),r instanceof Error&&r.name==="DeveloperError"){const a=r;console.error(a),v.initCompleted({result:"failed",eventType:"[".concat(a.name,"]: ").concat(a.code)});return}v.initCompleted({result:"failed"}),f.notify(r)}}async attributeChangedCallback(t,n,r){n!==r&&(_n(this,t,r),t==="has-selling-plan"&&this.toggleBuyerConsent(this.wrapper,this.apiClient,this.i18n))}render(t,n){if(!this.wrapper)throw new Error("[DynamicCheckout] tried to render with no wrapper element");this.clearUI(),this.wrapper=document.createElement("div");const r=document.createElement("style");r.innerHTML=Pn,this.wrapper.className="wallet-button-fade-in",this.wrapper.appendChild(t),this.renderMorePaymentOptionsLink(n);const a=new DocumentFragment;a.appendChild(r),a.appendChild(this.wrapper),this.appendChild(a)}renderMorePaymentOptionsLink(t){var n,r;if(t===m.BuyItNow)return;const a=document.createElement("more-payment-options-link");ee(a,{"buyer-country":(n=this.buyerCountry)!=null?n:"","access-token":(r=this.accessToken)!=null?r:"",disabled:String(this.disabled)}),a.setDataSource(this.dataSource),a.setI18n(this.i18n),a.setClassNames(Bt.MORE_PAYMENT_OPTION_BUTTON),this.wrapper.appendChild(a)}clearUI(){this.innerHTML=""}validateRenderingSurface(){return ae(this)!=null}async loadWallet(){const t=In(this.walletConfigs,"DynamicCheckout");return await Ra(t)}};c(_t,"instanceCount",0);let Yt=_t;function Na(e){var t;if(!sr())return null;const n=(t=lr())==null?void 0:t.toLowerCase();return n?e.find(r=>r.getInstrumentName().toLowerCase().includes(n)):null}function Da(e){return e===m.BuyItNow?Bt.UNBRANDED_BUTTON:Bt.BRANDED_BUTTON}async function Ra(e){var t;const n={name:"buy_it_now",wallet_params:{}};e.push(n);const r=Tn(En(e)),a=(t=Na(r))!=null?t:r[0];return await a.loadWalletSDK(),a.getPartnerSDKEligibility().eligible?a:r.find(o=>o.getInstrumentName()===m.BuyItNow)}R("dynamic-checkout",Yt),R("more-payment-options-link",Qr,{isChildCustomElement:!0}),R("buyer-consent",re,{isChildCustomElement:!0});const xa=e=>{const t=new PerformanceObserver(n=>{n.getEntriesByType("resource").some(r=>r.name.includes(lt.CartUpdate)||r.name.includes(lt.CartChange)||r.name.includes(lt.CartAdd)||r.name.includes(lt.CartClear))&&e()});return t.observe({entryTypes:["resource"]}),t},La=".additional-checkout-buttons,.additional-checkout-buttons--vertical{container-type:inline-size;container-name:acb}.wallet-cart-button-container,.wallet-cart-button{height:44px;width:150px;max-width:400px}.wallet-cart-grid{margin:0;padding:0;display:flex;gap:1rem;justify-content:flex-end;flex-direction:row}.additional-checkout-buttons--vertical .wallet-cart-grid{justify-content:flex-start;flex-direction:column}.additional-checkout-buttons--vertical .wallet-cart-grid .wallet-cart-button-container,.additional-checkout-buttons--vertical .wallet-cart-grid .wallet-cart-button{width:100%}@container acb (width >= 150px) and (width <= 400px){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))){justify-content:flex-start;flex-direction:column}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))) .wallet-cart-button-container,.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(1)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(2))) .wallet-cart-button{width:100%}}@container acb (width <= calc(300px + 1rem)){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))){justify-content:flex-start;flex-direction:column}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))) .wallet-cart-button-container,.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(2)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(3))) .wallet-cart-button{width:100%}}@container acb (width <= calc(450px + 2rem)){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))){justify-content:flex-start;flex-direction:column}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))) .wallet-cart-button-container,.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(3)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(4))) .wallet-cart-button{width:100%}}@container acb (width <= calc(600px + 3rem)){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))){justify-content:flex-start;flex-direction:column}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))) .wallet-cart-button-container,.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(4)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(5))) .wallet-cart-button{width:100%}}@container acb (width <= calc(750px + 4rem)){.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))){justify-content:flex-start;flex-direction:column}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))) .wallet-cart-button-container,.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(5)).wallet-cart-grid:not(:has(>.wallet-cart-button-container:nth-of-type(6))) .wallet-cart-button{width:100%}}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)){justify-content:flex-start;flex-direction:column}.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)) .wallet-cart-button-container,.wallet-cart-grid:has(>.wallet-cart-button-container:nth-of-type(6)) .wallet-cart-button{width:100%}@media screen and (max-width: 750px){.wallet-cart-grid{justify-content:flex-start;flex-direction:column}.wallet-cart-grid .wallet-cart-button-container,.wallet-cart-grid .wallet-cart-button{width:100%}}@supports (not (container-type: inline-size)) or (not (selector(:has(*)))){.wallet-cart-grid{justify-content:flex-start;flex-direction:column;gap:0px}.wallet-cart-button-container{width:100%;margin-bottom:10px}.wallet-cart-grid .wallet-cart-button{width:100%}}@keyframes walletsLoadingSkeleton{50%{opacity:1}75%{opacity:.5}to{opacity:1}}.wallet-cart-button__skeleton{animation:walletsLoadingSkeleton 4s ease infinite;animation-delay:-.168s;background-color:#dedede;box-sizing:border-box;text-decoration:none!important}";class St{constructor(t,n,r){this.cartToken=t,this.apiClient=n,this.requiresShipping=r}async getCart(){return{cart:await this.apiClient.fetchCart("gid://shopify/Cart/".concat(this.cartToken)),errors:[]}}shippingRequired(){return this.requiresShipping}async updateAttributesBasedOnCart(){const{cart:t}=await this.getCart();if(!t||!t.id)throw new Error("[".concat(St,"] received invalid cart"));if(!t.checkoutUrl)throw new Error("[".concat(St,"] Created cart with no checkout URL"));const n=t.lineItems.some(a=>a.merchandise.requiresShipping);this.requiresShipping=n;const r=t.lineItems.some(a=>a.sellingPlanAllocation!=null);return{requiresShipping:n,hasSellingPlan:r}}}const It=class Ua extends oe{constructor(){super(),c(this,"instanceNumber",++Ua.instanceCount),c(this,"cartObserver",null),c(this,"dataSource",null),c(this,"wrapper",document.createElement("div")),c(this,"apiClient"),c(this,"i18n"),Zt({shop:{shopId:this.shopId,cartId:this.cartId}}),kn({instanceNumber:this.instanceNumber,styleId:"shopify-dynamic-checkout-cart-grid",styles:La,cssFileName:"cart-wallet-buttons-base.css"})}static get observedAttributes(){return["access-token","has-selling-plan"]}isComponentVisible(){var t,n;const r=()=>{if(!this.isConnected)return!1;const a=getComputedStyle(this);return!(a.getPropertyValue("display")==="none"||a.getPropertyValue("visibility")!=="visible")};return(n=(t=this.checkVisibility)==null?void 0:t.call(this,{checkVisibilityCSS:!0}))!=null?n:r()}async createDataSource(t){const n=Ct("cart");if(!n)throw new Error("[CartWalletButtons] cart cookie does not exist");const r=kt(),a=new Rt({accessToken:this.accessToken,country:this.buyerCountry,locale:r.locale,withCarrierRates:t}),o=new St(n,a,!!this.hasAttribute("requires-shipping"));return this.dataSource=o,this.apiClient=a,this.i18n=r,{i18n:r,apiClient:a,dataSource:o}}async createWebComponents(){if(!this.walletConfigs)throw new Error("[CartWalletButtons] walletConfigs does not exist");const t=In(this.walletConfigs,"CartWalletButtons");if(!(t instanceof Array))throw new Error("[CartWalletButtons] invalid walletConfigs found");const n=t.some(i=>i.name==="apple_pay"),{i18n:r,apiClient:a,dataSource:o}=await this.createDataSource(n);return(await Oa(t,this.instanceNumber)).map(i=>i.createWebComponent({accessToken:this.accessToken,country:this.buyerCountry,currency:this.buyerCurrency,dataSource:o,i18n:r,apiClient:a,classNames:Kn,pageType:_.CartPage}))}async cartChangedCallback(){var t;try{if(this.dataSource){const{hasSellingPlan:n}=await((t=this.dataSource)==null?void 0:t.updateAttributesBasedOnCart());this.hasSellingPlan=n}else await this.render()}catch(n){this.innerHTML="",f.notify(n)}}async connectedCallback(){try{U({event:I.CartInitCalled}),this.cartObserver=xa(()=>this.cartChangedCallback());const t=Ct("cart");if(!this.isComponentVisible()&&!t)return;await this.render()}catch(t){this.innerHTML="",f.notify(t)}}disconnectedCallback(){var t;(t=this.cartObserver)==null||t.disconnect()}async attributeChangedCallback(t,n,r){n!==r&&(_n(this,t,r),t==="has-selling-plan"&&this.toggleBuyerConsent(this.wrapper,this.apiClient,this.i18n))}async render(){const t=xt(mt.ButtonDisplay,"cart:".concat(this.instanceNumber)),n=await this.createWebComponents();if(this.innerHTML="",n.length===0)return;const r=document.createElement("style");r.innerHTML=Pn,this.wrapper=document.createElement("div"),this.wrapper.className="wallet-button-fade-in";const a=document.createElement("div");a.className="wallet-cart-grid",a.setAttribute("data-shopify-buttoncontainer","true"),n.forEach(i=>{const s=document.createElement("div");s.className="wallet-cart-button-container",s.appendChild(i),a.appendChild(s)}),this.wrapper.appendChild(a),this.toggleBuyerConsent(this.wrapper,this.apiClient,this.i18n);const o=new DocumentFragment;o.appendChild(r),o.appendChild(this.wrapper),this.appendChild(o),U({event:I.InstrumentLoaded,instrumentId:"CartWalletButtons",ttl:t()})}};c(It,"instanceCount",0);let Qt=It;async function Oa(e,t){const n=Tn(En(e));return await Promise.all(n.map(async r=>{try{const a=r.getInstrumentName(),o=xt(mt.LoadInstrument,"".concat(a,":").concat(t));await r.loadWalletSDK(),v.instrumentLoaded({instrument:a,measurement:o()})}catch(a){f.notify(a)}})),n.filter(r=>r.getPartnerSDKEligibility().eligible)}R("cart-wallet-buttons",Qt);class $a{getCart(){throw new Error('[NoOpDataSource] Unexpected call to "getCart"')}shippingRequired(){throw new Error('[NoOpDataSource] Unexpected call to "shippingRequired"')}}const Tt=class Ba extends oe{constructor(){super(),c(this,"instanceNumber",++Ba.instanceCount),c(this,"i18n"),Zt({shop:{shopId:this.shopId}})}get walletConfig(){return this.getAttribute("wallet-config")}async connectedCallback(){try{if(this.children.length)return;this.instanceNumber===1&&v.initStarted();const t=xt(mt.ButtonDisplay,"dc:".concat(this.instanceNumber)),n=_a(this.walletConfig,"WalletButton");if(!n)throw new to("[WalletButton] No config provided.");const r=Sn(n);if(!r||!await this.eligibleToShow(r))return;const a=r.getInstrumentName();this.i18n=kt();const o=new Rt({accessToken:this.accessToken,country:this.buyerCountry,locale:this.i18n.locale}),i=this.createWebComponent(r,this.i18n,o,a,t);this.innerHTML="",this.appendChild(i),v.initCompleted({result:"success"}),this.instanceNumber===1&&this.triggerLoadedEvent()}catch(t){this.innerHTML="",v.initCompleted({result:"failed"}),f.notify(t)}}createWebComponent(t,n,r,a,o){const i=t.createWebComponent({accessToken:this.accessToken,country:this.buyerCountry,currency:this.buyerCurrency,disabled:String(this.disabled),dataSource:new $a,i18n:n,apiClient:r});return i.onRendered=()=>{v.instrumentLoaded({instrument:a,measurement:o()})},i}async eligibleToShow(t){return!(!t.getLoadEligibility().eligible||(await t.loadWalletSDK(),!t.getPartnerSDKEligibility().eligible))}};c(Tt,"instanceCount",0);let Jt=Tt;R("shopify-wallet-button",Jt),jn(f),Hn(f),v.startExporter();
